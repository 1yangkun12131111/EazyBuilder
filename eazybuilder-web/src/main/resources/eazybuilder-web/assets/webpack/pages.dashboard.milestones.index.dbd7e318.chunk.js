(this.webpackJsonp=this.webpackJsonp||[]).push([[213],{"2jmK":function(e,t,r){"use strict";r.r(t);var s=r("k/Fq");document.addEventListener("DOMContentLoaded",s.a)},43:function(e,t,r){r("HVBj"),e.exports=r("2jmK")},"k/Fq":function(e,t,r){"use strict";r("jaBk");var s=r("EmJ/"),n=r.n(s),o=r("qPgm"),a=r("qnJZ"),c=r("/lV4"),i=(r("pBsb"),r("n7CP"));class l{constructor(e){this.projectSelectInput=n()(e),this.newItemBtn=n()(".new-project-item-link"),this.resourceType=this.newItemBtn.data("type"),this.resourceLabel=this.newItemBtn.data("label"),this.formattedText=this.deriveTextVariants(),this.groupId=this.projectSelectInput.data("groupId"),this.bindEvents(),this.initLocalStorage()}bindEvents(){var e=this;this.projectSelectInput.siblings(".new-project-item-select-button").on("click",(function(t){return e.openDropdown(t)})),this.newItemBtn.on("click",(function(t){e.getProjectFromLocalStorage()||(t.preventDefault(),e.openDropdown(t))})),this.projectSelectInput.on("change",(function(){return e.selectProject()}))}initLocalStorage(){i.a.isLocalStorageAccessSafe()&&(this.localStorageKey=["group",this.groupId,this.formattedText.localStorageItemType,"recent-project"].join("-"),this.setBtnTextFromLocalStorage())}openDropdown(e){r.e(443).then(r.t.bind(null,"p9g0",7)).then((function(){Object(a.a)(gon.select2_css_path).then((function(){n()(e.currentTarget).siblings(".project-item-select").select2("open")})).catch((function(){}))})).catch((function(){}))}selectProject(){const e=JSON.parse(this.projectSelectInput.val()),t={url:"".concat(e.url,"/").concat(this.projectSelectInput.data("relativePath")),name:e.name};this.setNewItemBtnAttributes(t),this.setProjectInLocalStorage(t)}setBtnTextFromLocalStorage(){const e=this.getProjectFromLocalStorage();this.setNewItemBtnAttributes(e)}setNewItemBtnAttributes(e){e?(this.newItemBtn.attr("href",e.url),this.newItemBtn.text("".concat(this.formattedText.defaultTextPrefix," in ").concat(e.name))):this.newItemBtn.text("Select project to create ".concat(this.formattedText.presetTextSuffix))}getProjectFromLocalStorage(){const e=localStorage.getItem(this.localStorageKey);return JSON.parse(e)}setProjectInLocalStorage(e){const t=JSON.stringify(e);localStorage.setItem(this.localStorageKey,t)}deriveTextVariants(){const e=this.resourceLabel;return{localStorageItemType:"new-".concat(this.resourceType.split("_").join("-").slice(0,-1)),defaultTextPrefix:e,presetTextSuffix:this.resourceType.split("_").join(" ").slice(0,-1)}}}const u=function(){Object(a.a)(gon.select2_css_path).then((function(){n()(".ajax-project-select").each((function(e,t){var r=this;let s;const a=n()(t).data("simpleFilter")||!1,i=n()(t).data("select2");return this.groupId=n()(t).data("groupId"),this.userId=n()(t).data("userId"),this.includeGroups=n()(t).data("includeGroups"),this.allProjects=n()(t).data("allProjects")||!1,this.orderBy=n()(t).data("orderBy")||"id",this.withIssuesEnabled=n()(t).data("withIssuesEnabled"),this.withMergeRequestsEnabled=n()(t).data("withMergeRequestsEnabled"),this.withShared=void 0===n()(t).data("withShared")||n()(t).data("withShared"),this.includeProjectsInSubgroups=n()(t).data("includeProjectsInSubgroups")||!1,this.allowClear=n()(t).data("allowClear")||!1,s=Object(c.e)("ProjectSelect|Search for project"),this.includeGroups&&(s+=Object(c.e)("ProjectSelect| or group")),n()(t).select2({placeholder:s,minimumInputLength:0,query:function(e){let t;const s=function(t){const r={results:t};return e.callback(r)};return t=r.includeGroups?function(t){return o.a.groups(e.term,{},(function(e){const r=e.concat(t);return s(r)}))}:s,r.groupId?o.a.groupProjects(r.groupId,e.term,{with_issues_enabled:r.withIssuesEnabled,with_merge_requests_enabled:r.withMergeRequestsEnabled,with_shared:r.withShared,include_subgroups:r.includeProjectsInSubgroups,order_by:"similarity",simple:!0},t):r.userId?o.a.userProjects(r.userId,e.term,{with_issues_enabled:r.withIssuesEnabled,with_merge_requests_enabled:r.withMergeRequestsEnabled,with_shared:r.withShared,include_subgroups:r.includeProjectsInSubgroups},t):o.a.projects(e.term,{order_by:r.orderBy,with_issues_enabled:r.withIssuesEnabled,with_merge_requests_enabled:r.withMergeRequestsEnabled,membership:!r.allProjects},t)},id:e=>a?e.id:JSON.stringify({name:e.name,url:e.web_url}),text:e=>e.name_with_namespace||e.name,initSelection:(e,t)=>o.a.project(e.val()).then((function(e){let{data:r}=e;return t(r)})),allowClear:this.allowClear,dropdownCssClass:"ajax-project-dropdown"}),i||a?t:new l(t)}))})).catch((function(){}))};t.a=function(){n()(".ajax-project-select").length&&r.e(443).then(r.t.bind(null,"p9g0",7)).then(u).catch((function(){}))}}},[[43,1,0,2]]]);
//# sourceMappingURL=pages.dashboard.milestones.index.dbd7e318.chunk.js.map