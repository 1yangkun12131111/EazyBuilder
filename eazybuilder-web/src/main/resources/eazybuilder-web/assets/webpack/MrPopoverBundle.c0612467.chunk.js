(this.webpackJsonp=this.webpackJsonp||[]).push([[147,465],{"50H4":function(e,t){var n={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"mergeRequest"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"projectPath"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"mergeRequestIID"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}},directives:[]}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"project"},arguments:[{kind:"Argument",name:{kind:"Name",value:"fullPath"},value:{kind:"Variable",name:{kind:"Name",value:"projectPath"}}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"mergeRequest"},arguments:[{kind:"Argument",name:{kind:"Name",value:"iid"},value:{kind:"Variable",name:{kind:"Name",value:"mergeRequestIID"}}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"createdAt"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"state"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"headPipeline"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"detailedStatus"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"icon"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"group"},arguments:[],directives:[]}]}}]}}]}}]}}]}}],loc:{start:0,end:280}};n.loc.source={body:"query mergeRequest($projectPath: ID!, $mergeRequestIID: String!) {\n  project(fullPath: $projectPath) {\n    mergeRequest(iid: $mergeRequestIID) {\n      createdAt\n      state\n      headPipeline {\n        detailedStatus {\n          icon\n          group\n        }\n      }\n    }\n  }\n}\n",name:"GraphQL request",locationOffset:{line:1,column:1}};var i={};function r(e,t){for(var n=0;n<e.definitions.length;n++){var i=e.definitions[n];if(i.name&&i.name.value==t)return i}}n.definitions.forEach((function(e){if(e.name){var t=new Set;!function e(t,n){if("FragmentSpread"===t.kind)n.add(t.name.value);else if("VariableDefinition"===t.kind){var i=t.type;"NamedType"===i.kind&&n.add(i.name.value)}t.selectionSet&&t.selectionSet.selections.forEach((function(t){e(t,n)})),t.variableDefinitions&&t.variableDefinitions.forEach((function(t){e(t,n)})),t.definitions&&t.definitions.forEach((function(t){e(t,n)}))}(e,t),i[e.name.value]=t}})),e.exports=n,e.exports.mergeRequest=function(e,t){var n={kind:e.kind,definitions:[r(e,t)]};e.hasOwnProperty("loc")&&(n.loc=e.loc);var o=i[t]||new Set,s=new Set,a=new Set;for(o.forEach((function(e){a.add(e)}));a.size>0;){var c=a;a=new Set,c.forEach((function(e){s.has(e)||(s.add(e),(i[e]||new Set).forEach((function(e){a.add(e)})))}))}return s.forEach((function(t){var i=r(e,t);i&&n.definitions.push(i)})),n}(n,"mergeRequest")},"5QKO":function(e,t,n){"use strict";var i=n("bOix");t.a={methods:{timeFormatted:e=>Object(i.r)().format(e),tooltipTitle:e=>Object(i.h)(e),durationTimeFormatted(e){const t=new Date(1e3*e);let n=t.getUTCHours(),i=t.getUTCMinutes(),r=t.getSeconds();return n<10&&(n="0".concat(n)),i<10&&(i="0".concat(i)),r<10&&(r="0".concat(r)),"".concat(n,":").concat(i,":").concat(r)}}}},"5v28":function(e,t,n){"use strict";n.r(t),n.d(t,"fetchPolicies",(function(){return L}));n("S26F"),n("pBsb");var i=n("gr1B"),r=n("pvem"),o=n("KeHV"),s=n("5lEE"),a=n("M/w7"),c=n("VoMd"),l=n("e0vG"),u=n("scFH"),d=n("qDEO");const p=function(){return(new Date).getTime()},h=function(e){return(p()-e)/1e3};class m{constructor(e){this.visibilityDidChange=this.visibilityDidChange.bind(this),this.connection=e,this.reconnectAttempts=0}start(){this.isRunning()||(this.startedAt=p(),delete this.stoppedAt,this.startPolling(),addEventListener("visibilitychange",this.visibilityDidChange),d.logger.log("ConnectionMonitor started. stale threshold = ".concat(this.constructor.staleThreshold," s")))}stop(){this.isRunning()&&(this.stoppedAt=p(),this.stopPolling(),removeEventListener("visibilitychange",this.visibilityDidChange),d.logger.log("ConnectionMonitor stopped"))}isRunning(){return this.startedAt&&!this.stoppedAt}recordPing(){this.pingedAt=p()}recordConnect(){this.reconnectAttempts=0,this.recordPing(),delete this.disconnectedAt,d.logger.log("ConnectionMonitor recorded connect")}recordDisconnect(){this.disconnectedAt=p(),d.logger.log("ConnectionMonitor recorded disconnect")}startPolling(){this.stopPolling(),this.poll()}stopPolling(){clearTimeout(this.pollTimeout)}poll(){var e=this;this.pollTimeout=setTimeout((function(){e.reconnectIfStale(),e.poll()}),this.getPollInterval())}getPollInterval(){const{staleThreshold:e,reconnectionBackoffRate:t}=this.constructor;return 1e3*e*(1+t)**Math.min(this.reconnectAttempts,10)*(1+(0===this.reconnectAttempts?1:t)*Math.random())}reconnectIfStale(){this.connectionIsStale()&&(d.logger.log("ConnectionMonitor detected stale connection. reconnectAttempts = ".concat(this.reconnectAttempts,", time stale = ").concat(h(this.refreshedAt)," s, stale threshold = ").concat(this.constructor.staleThreshold," s")),this.reconnectAttempts+=1,this.disconnectedRecently()?d.logger.log("ConnectionMonitor skipping reopening recent disconnect. time disconnected = ".concat(h(this.disconnectedAt)," s")):(d.logger.log("ConnectionMonitor reopening"),this.connection.reopen()))}get refreshedAt(){return this.pingedAt?this.pingedAt:this.startedAt}connectionIsStale(){return h(this.refreshedAt)>this.constructor.staleThreshold}disconnectedRecently(){return this.disconnectedAt&&h(this.disconnectedAt)<this.constructor.staleThreshold}visibilityDidChange(){var e=this;"visible"===document.visibilityState&&setTimeout((function(){!e.connectionIsStale()&&e.connection.isOpen()||(d.logger.log("ConnectionMonitor reopening stale connection on visibilitychange. visibilityState = ".concat(document.visibilityState)),e.connection.reopen())}),200)}}m.staleThreshold=6,m.reconnectionBackoffRate=.15;var f=m;const g=Object(d.createConsumer)();g.connection&&(g.connection.monitor=new f(g.connection));var v=g,b=n("WelT");class y extends o.ApolloLink{request(e){return new l.a((function(t){const n=v.subscriptions.create({channel:"GraphqlChannel",query:e.query?Object(u.a)(e.query):null,variables:e.variables,operationName:e.operationName,nonce:Object(b.a)()[0]},{received(e){e.errors?t.error(e.errors):e.result&&t.next(e.result),e.more||t.complete()}});return{unsubscribe(){n.unsubscribe()}}}))}}n("QzWB"),n("TXLM"),n("jaBk");const k=new o.ApolloLink((function(e,t){return t(e).flatMap((function(i){const{errors:r=[]}=i,o=r.find((function(e){var t;return null==e?void 0:null===(t=e.extensions)||void 0===t?void 0:t.needs_captcha_response}));if(o){const i=o.extensions.captcha_site_key,r=o.extensions.spam_log_id;return new l.a((function(o){Promise.all([n.e(52),n.e(457)]).then(n.bind(null,"aG+H")).then((function(e){let{waitForCaptchaToBeSolved:t}=e;return t(i)})).then((function(n){e.setContext({headers:{"X-GitLab-Captcha-Response":n,"X-GitLab-Spam-Log-Id":r}}),t(e).subscribe(o)})).catch((function(e){o.error(e),o.complete()}))}))}return l.a.of(i)}))}));n("Tznw"),n("6yen"),n("OeRx"),n("l/dT"),n("RqS2"),n("Zy7a"),n("cjZU"),n("OAhk"),n("X42P"),n("mHhP"),n("fn0I"),n("UB/6"),n("imhG"),n("orcL");var C=n("osXd"),q=n.n(C),w=n("VNnR"),S=n.n(w),O=n("VvTQ");const A=function(e){return q()(e,(function(e){return void 0!==e}))},R=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return S()(A(e),A(t))};class j extends o.ApolloLink{constructor(){var e;super(),this.startupCalls=new Map,this.parseStartupCalls((null===(e=window.gl)||void 0===e?void 0:e.startup_graphql_calls)||[])}parseStartupCalls(e){var t=this;e.forEach((function(e){var n,i,r,o;const{query:s,variables:a,fetchCall:c}=e,l=null===(n=Object(O.a)(s))||void 0===n?void 0:null===(i=n.definitions)||void 0===i?void 0:null===(r=i.find((function(e){return"OperationDefinition"===e.kind})))||void 0===r?void 0:null===(o=r.name)||void 0===o?void 0:o.value;l&&t.startupCalls.set(l,{variables:a,fetchCall:c})}))}disable(){this.request=j.noopRequest,this.startupCalls=null}request(e,t){if(this.startupCalls&&0===this.startupCalls.size)return this.disable(),t(e);const{operationName:n}=e;if(!this.startupCalls.has(n))return t(e);const{variables:i,fetchCall:r}=this.startupCalls.get(n);return this.startupCalls.delete(n),R(i,e.variables)?new l.a((function(n){r.then((function(t){if(!t.ok)throw new Error("fetchCall failed");return e.setContext({response:t}),t.json()})).then((function(e){if(e&&(e.errors||!e.data))throw new Error("Received GraphQL error");n.next(e),n.complete()})).catch((function(){t(e).subscribe({next:function(e){n.next(e)},error:function(e){n.error(e)},complete:n.complete.bind(n)})}))})):t(e)}}var P,x,T;T=function(e,t){return t(e)},(x="noopRequest")in(P=j)?Object.defineProperty(P,x,{value:T,enumerable:!0,configurable:!0,writable:!0}):P[x]=T;var D=n("Qhxq"),N=n("hamy");function _(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,i)}return n}function I(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?_(Object(n),!0).forEach((function(t){E(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):_(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function E(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}const L={CACHE_FIRST:"cache-first",CACHE_AND_NETWORK:"cache-and-network",NETWORK_ONLY:"network-only",NO_CACHE:"no-cache",CACHE_ONLY:"cache-only"};t.default=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const{assumeImmutableResults:n,baseUrl:l,batchMax:u=10,cacheConfig:d,fetchPolicy:p=L.CACHE_FIRST,typeDefs:h,path:m="/api/graphql",useGet:f=!1}=t;let g="".concat(gon.relative_url_root||"").concat(m);l&&(g="".concat(l).concat(g).replace(/\/{3,}/g,"/"));const v={uri:g,headers:{[D.a.headerKey]:D.a.token},credentials:"same-origin",batchMax:u},b=new o.ApolloLink((function(e,t){return window.pendingApolloRequests=window.pendingApolloRequests||0,window.pendingApolloRequests+=1,t(e).map((function(e){return window.pendingApolloRequests-=1,e}))})),C=o.ApolloLink.split((function(e){return e.getContext().hasUpload||e.getContext().isSingleRequest}),Object(c.createUploadLink)(v),f?Object(a.a)(v):new s.a(v)),q=new o.ApolloLink((function(e,t){return t(e).map((function(t){const n=e.getContext().response;return N.a.interceptor&&N.a.interceptor({config:{url:n.url},headers:{"x-request-id":n.headers.get("x-request-id"),"x-gitlab-from-cache":n.headers.get("x-gitlab-from-cache")}}),t}))})),w=function(e){let{query:{definitions:t}}=e;return t.some((function(e){let{kind:t,operation:n}=e;return"OperationDefinition"===t&&"subscription"===n}))},S=o.ApolloLink.split(w,new y,o.ApolloLink.from([b,q,new j,k,C]));return new r.a({typeDefs:h,link:S,cache:new i.a(I(I({},d),{},{freezeResults:n})),resolvers:e,assumeImmutableResults:n,defaultOptions:{query:{fetchPolicy:p}}})}},"8zNS":function(e,t,n){"use strict";var i=n("s1D3");const r=[8,12,16,18,24,32,48,72];var o={components:{GlIcon:i.a},props:{status:{type:Object,required:!0},size:{type:Number,required:!1,default:16,validator:e=>r.includes(e)},borderless:{type:Boolean,required:!1,default:!1},cssClasses:{type:String,required:!1,default:""}},computed:{cssClass(){const e=this.status.group;return"ci-status-icon ci-status-icon-".concat(e," js-ci-status-icon-").concat(e)},icon(){return this.borderless?"".concat(this.status.icon,"_borderless"):this.status.icon}}},s=n("tBpV"),a=Object(s.a)(o,(function(){var e=this.$createElement,t=this._self._c||e;return t("span",{class:this.cssClass},[t("gl-icon",{class:this.cssClasses,attrs:{name:this.icon,size:this.size,"aria-label":this.status.icon,"use-deprecated-sizes":""}})],1)}),[],!1,null,null,null);t.a=a.exports},TBBL:function(e,t,n){"use strict";var i=n("Pyw5");const r={props:{lines:{type:Number,required:!1,default:3,validator:function(e){return e>0&&e<4}}},computed:{lineClasses:function(){return new Array(this.lines).fill().map((function(e,t){return"skeleton-line-".concat(t+1)}))}}};const o=n.n(i)()({render:function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"animation-container"},this._l(this.lineClasses,(function(e,n){return t("div",{key:n,class:e})})),0)},staticRenderFns:[]},void 0,r,void 0,!1,void 0,!1,void 0,void 0,void 0);t.a=o},WelT:function(e,t,n){"use strict";n.d(t,"a",(function(){return d}));n("C0ry"),n("orcL");var i=n("lx39"),r=n.n(i),o=n("iGym"),s=n("xjzK"),a=n.n(s),c=n("iPR/");function l(){let e;for(var t=arguments.length,n=new Array(t),i=0;i<t;i++)n[i]=arguments[i];return e=n.length?function(e){return e.reduce((function(t,n,i){let o=0;return Number.isInteger(n)?o=n:r()(n)&&(o=a()(n)),t+(e.length-i)*o}),0)}(n):Math.floor(1e15*Math.random()),new o.a(e)}function u(e){const t=[];for(let n=0;n<=3;n+=1){const n=new ArrayBuffer(4),i=new DataView(n);i.setUint32(0,e.randomNumber()),t.push(i.getUint8(0),i.getUint8(1),i.getUint8(2),i.getUint8(3))}return t}function d(){let{seeds:e=[],count:t=1}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const n=l(...e);return Array(t).fill(0).map((function(){return Object(c.a)({random:u(n)})}))}},hamy:function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));n("orcL");var i,r,o,s=n("NmEs"),a=n("2ibD");class c{static fetchRequestDetails(e,t){return a.a.get(e,{params:{request_id:t}})}static registerInterceptor(e,t){return c.interceptor=function(n){const[i,r,o]=c.callbackParams(n,e);return i&&t(r,o),n},a.a.interceptors.response.use(c.interceptor)}static removeInterceptor(){a.a.interceptors.response.eject(c.interceptor),c.interceptor=null}static callbackParams(e,t){var n;const i=e.headers&&e.headers["x-request-id"],r=null===(n=e.config)||void 0===n?void 0:n.url,o=e.headers&&Object(s.K)(e.headers["x-gitlab-from-cache"]);return[r!==t&&Boolean(i)&&!o,i,r]}}o=null,(r="interceptor")in(i=c)?Object.defineProperty(i,r,{value:o,enumerable:!0,configurable:!0,writable:!0}):i[r]=o},lzIs:function(e,t,n){"use strict";n.r(t);n("orcL");var i=n("jB52"),r=n("GiFX"),o=n("5v28"),s=n("A7K0"),a=n("TBBL"),c=n("8zNS"),l=n("5QKO"),u=n("/lV4");const d="merged",p="closed",h={merged:Object(u.a)("Merged"),closed:Object(u.a)("Closed"),open:Object(u.a)("Open")};var m=n("50H4"),f=n.n(m),g={name:"MRPopover",components:{GlPopover:s.a,GlSkeletonLoading:a.a,CiIcon:c.a},mixins:[l.a],props:{target:{type:HTMLAnchorElement,required:!0},projectPath:{type:String,required:!0},mergeRequestIID:{type:String,required:!0},mergeRequestTitle:{type:String,required:!0}},data:()=>({mergeRequest:{}}),computed:{detailedStatus(){return this.mergeRequest.headPipeline&&this.mergeRequest.headPipeline.detailedStatus},formattedTime(){return this.timeFormatted(this.mergeRequest.createdAt)},statusBoxClass(){switch(this.mergeRequest.state){case d:return"status-box-mr-merged";case p:return"status-box-closed";default:return"status-box-open"}},stateHumanName(){switch(this.mergeRequest.state){case d:return h.merged;case p:return h.closed;default:return h.open}},showDetails(){return Object.keys(this.mergeRequest).length>0}},apollo:{mergeRequest:{query:f.a,update:function(e){return e.project.mergeRequest},variables(){const{projectPath:e,mergeRequestIID:t}=this;return{projectPath:e,mergeRequestIID:t}}}}},v=n("tBpV"),b=Object(v.a)(g,(function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("gl-popover",{attrs:{target:e.target,boundary:"viewport",placement:"top",show:""}},[n("div",{staticClass:"mr-popover"},[e.$apollo.loading?n("div",[n("gl-skeleton-loading",{staticClass:"animation-container-small mt-1",attrs:{lines:1}})],1):e.showDetails?n("div",{staticClass:"d-flex align-items-center justify-content-between"},[n("div",{staticClass:"d-inline-flex align-items-center"},[n("div",{class:"issuable-status-box status-box "+e.statusBoxClass},[e._v("\n          "+e._s(e.stateHumanName)+"\n        ")]),e._v(" "),n("span",{staticClass:"text-secondary"},[e._v("Opened "),n("time",{domProps:{textContent:e._s(e.formattedTime)}})])]),e._v(" "),e.detailedStatus?n("ci-icon",{attrs:{status:e.detailedStatus}}):e._e()],1):e._e(),e._v(" "),n("h5",{staticClass:"my-2"},[e._v(e._s(e.mergeRequestTitle))]),e._v(" "),n("div",{staticClass:"text-secondary"},[e._v("\n      "+e._s(e.projectPath+"!"+e.mergeRequestIID)+"\n    ")])])])}),[],!1,null,null,null).exports;let y,k;const C=function e(t){let{target:n}=t;n.removeEventListener("mouseleave",e),k&&clearTimeout(k),y&&(y.$destroy(),y=null)};t.default=function(e){const t=e||[...document.querySelectorAll(".gfm-merge_request")];if(t.length>0){i.default.use(r.default);const e=new r.default({defaultClient:Object(o.default)()}),n="data-mr-listener-added";t.forEach((function(t){const{projectPath:r,mrTitle:o,iid:s}=t.dataset;!t.getAttribute(n)&&r&&o&&s&&(t.addEventListener("mouseenter",function(e){let{apolloProvider:t,projectPath:n,mrTitle:r,iid:o}=e;return function(e){let{target:s}=e;s.addEventListener("mouseleave",C),k=setTimeout((function(){const e=i.default.extend(b);(y=new e({propsData:{target:s,projectPath:n,mergeRequestIID:o,mergeRequestTitle:r},apolloProvider:t})).$mount()}),200)}}({apolloProvider:e,projectPath:r,mrTitle:o,iid:s})),t.setAttribute(n,!0))}))}}}}]);
//# sourceMappingURL=MrPopoverBundle.c0612467.chunk.js.map