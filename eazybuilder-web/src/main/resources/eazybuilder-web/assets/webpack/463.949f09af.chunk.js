(this.webpackJsonp=this.webpackJsonp||[]).push([[463],{"8PW6":function(e,n,t){"use strict";t.r(n);t("pBsb");var i=t("l5WF"),a=t("OQy4"),r=t("rTAy"),o=(t("orcL"),t("e+NP")),s=t("tbP8"),l=t("N5YB"),d=t("ehHk"),c=t("FkSe"),u=t("b9Gi"),m=t("FxFN"),p=t("bJQs"),f=t.n(p);var v={name:"ProjectsTokenSelector",components:{GlTokenSelector:o.a,GlAvatar:s.a,GlAvatarLabeled:l.a,GlIntersectionObserver:d.a,GlLoadingIcon:c.a},model:{prop:"selectedProjects"},props:{selectedProjects:{type:Array,required:!0},initialProjectIds:{type:Array,required:!0}},apollo:{projects:{query:f.a,debounce:250,variables(){return{search:this.searchQuery,after:null,first:20}},update(e){let{projects:n}=e;return{list:Object(m.b)(n.nodes),pageInfo:n.pageInfo}},result(){this.isLoadingMoreProjects=!1,this.isSearching=!1}},initialProjects:{query:f.a,variables(){return{ids:Object(m.d)("Project",this.initialProjectIds)}},manual:!0,skip(){return!this.initialProjectIds.length},result(e){let{data:{projects:n}}=e;this.$emit("input",Object(m.b)(n.nodes))}}},data:()=>({projects:{list:[],pageInfo:{}},searchQuery:"",isLoadingMoreProjects:!1,isSearching:!1}),methods:{handleSearch(e){this.isSearching=!0,this.searchQuery=e},loadMoreProjects(){this.isLoadingMoreProjects=!0,this.$apollo.queries.projects.fetchMore({variables:{after:this.projects.pageInfo.endCursor,first:20},updateQuery(e,n){let{fetchMoreResult:{projects:t}}=n;const{projects:i}=e;return Object(u.a)(e,(function(e){e.projects.nodes=[...i.nodes,...t.nodes],e.projects.pageInfo=t.pageInfo}))}})}}},k=t("tBpV"),g=Object(k.a)(v,(function(){var e=this,n=e.$createElement,t=e._self._c||n;return t("div",{staticClass:"gl-relative"},[t("gl-token-selector",{attrs:{"selected-tokens":e.selectedProjects,"dropdown-items":e.projects.list,loading:e.isSearching,placeholder:e.__("Select projects"),"menu-class":"gl-w-full! gl-max-w-full!"},on:{input:function(n){return e.$emit("input",n)},focus:function(n){return e.$emit("focus",n)},"text-input":e.handleSearch,keydown:function(n){if(!n.type.indexOf("key")&&e._k(n.keyCode,"enter",13,n.key,"Enter"))return null;n.preventDefault()}},scopedSlots:e._u([{key:"token-content",fn:function(n){var i=n.token;return[t("gl-avatar",{attrs:{"entity-id":i.id,"entity-name":i.name,src:i.avatarUrl,size:16}}),e._v("\n      "+e._s(i.nameWithNamespace)+"\n    ")]}},{key:"dropdown-item-content",fn:function(e){var n=e.dropdownItem;return[t("gl-avatar-labeled",{attrs:{"entity-id":n.id,"entity-name":n.name,size:32,src:n.avatarUrl,label:n.name,"sub-label":n.nameWithNamespace}})]}},{key:"dropdown-footer",fn:function(){return[e.projects.pageInfo.hasNextPage?t("gl-intersection-observer",{on:{appear:e.loadMoreProjects}},[e.isLoadingMoreProjects?t("gl-loading-icon",{attrs:{size:"md"}}):e._e()],1):e._e()]},proxy:!0}])})],1)}),[],!1,null,null,null).exports,h={name:"ProjectsField",ALL_PROJECTS:"ALL_PROJECTS",SELECTED_PROJECTS:"SELECTED_PROJECTS",components:{GlFormGroup:i.a,GlFormRadio:a.a,GlFormText:r.a,ProjectsTokenSelector:g},props:{inputAttrs:{type:Object,required:!0}},data(){return{selectedRadio:this.inputAttrs.value?this.$options.SELECTED_PROJECTS:this.$options.ALL_PROJECTS,selectedProjects:[]}},computed:{allProjectsRadioSelected(){return this.selectedRadio===this.$options.ALL_PROJECTS},hiddenInputValue(){return this.allProjectsRadioSelected?null:this.selectedProjects.map((function(e){return e.id})).join(",")},initialProjectIds(){return this.inputAttrs.value?this.inputAttrs.value.split(","):[]}},methods:{handleTokenSelectorFocus(){this.selectedRadio=this.$options.SELECTED_PROJECTS}}},b=Object(k.a)(h,(function(){var e=this,n=e.$createElement,t=e._self._c||n;return t("div",[t("gl-form-group",{attrs:{label:e.__("Projects"),"label-class":"gl-pb-0!"}},[t("gl-form-text",{staticClass:"gl-pb-3"},[e._v(e._s(e.__("Set access permissions for this token.")))]),e._v(" "),t("gl-form-radio",{attrs:{value:e.$options.ALL_PROJECTS},model:{value:e.selectedRadio,callback:function(n){e.selectedRadio=n},expression:"selectedRadio"}},[e._v(e._s(e.__("All projects")))]),e._v(" "),t("gl-form-radio",{attrs:{value:e.$options.SELECTED_PROJECTS},model:{value:e.selectedRadio,callback:function(n){e.selectedRadio=n},expression:"selectedRadio"}},[e._v(e._s(e.__("Selected projects")))]),e._v(" "),t("input",{attrs:{id:e.inputAttrs.id,type:"hidden",name:e.inputAttrs.name},domProps:{value:e.hiddenInputValue}}),e._v(" "),t("projects-token-selector",{attrs:{"initial-project-ids":e.initialProjectIds},on:{focus:e.handleTokenSelectorFocus},model:{value:e.selectedProjects,callback:function(n){e.selectedProjects=n},expression:"selectedProjects"}})],1)],1)}),[],!1,null,null,null);n.default=b.exports},FxFN:function(e,n,t){"use strict";t.d(n,"e",(function(){return l})),t.d(n,"a",(function(){return d})),t.d(n,"c",(function(){return c})),t.d(n,"d",(function(){return u})),t.d(n,"b",(function(){return m}));t("S26F");var i=t("P/Kr"),a=t.n(i);function r(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);n&&(i=i.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,i)}return t}function o(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?r(Object(t),!0).forEach((function(n){s(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):r(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}function s(e,n,t){return n in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}const l=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return parseInt("".concat(e).replace(/gid:\/\/gitlab\/.*\//g,""),10)||null},d={Append:"APPEND",Remove:"REMOVE",Replace:"REPLACE"},c=function(e,n){if("string"!=typeof e)throw new TypeError("type must be a string; got ".concat(typeof e));if(!["number","string"].includes(typeof n))throw new TypeError("id must be a number or string; got ".concat(typeof n));return"gid://gitlab/".concat(e,"/").concat(n)},u=function(e,n){return n.map((function(n){return c(e,n)}))},m=function(e){if(!a()(e))throw new TypeError("nodes must be an array; got ".concat(typeof e));return e.map((function(e){return e.id?o(o({},e),{},{id:l(e.id)}):e}))}},bJQs:function(e,n,t){var i={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"getProjects"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"search"}},type:{kind:"NamedType",name:{kind:"Name",value:"String"}},defaultValue:{kind:"StringValue",value:"",block:!1},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"after"}},type:{kind:"NamedType",name:{kind:"Name",value:"String"}},defaultValue:{kind:"StringValue",value:"",block:!1},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"first"}},type:{kind:"NamedType",name:{kind:"Name",value:"Int"}},defaultValue:{kind:"NullValue"},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"ids"}},type:{kind:"ListType",type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}}},defaultValue:{kind:"NullValue"},directives:[]}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"projects"},arguments:[{kind:"Argument",name:{kind:"Name",value:"search"},value:{kind:"Variable",name:{kind:"Name",value:"search"}}},{kind:"Argument",name:{kind:"Name",value:"after"},value:{kind:"Variable",name:{kind:"Name",value:"after"}}},{kind:"Argument",name:{kind:"Name",value:"first"},value:{kind:"Variable",name:{kind:"Name",value:"first"}}},{kind:"Argument",name:{kind:"Name",value:"ids"},value:{kind:"Variable",name:{kind:"Name",value:"ids"}}},{kind:"Argument",name:{kind:"Name",value:"membership"},value:{kind:"BooleanValue",value:!0}},{kind:"Argument",name:{kind:"Name",value:"searchNamespaces"},value:{kind:"BooleanValue",value:!0}},{kind:"Argument",name:{kind:"Name",value:"sort"},value:{kind:"StringValue",value:"UPDATED_ASC",block:!1}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"nodes"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"name"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"nameWithNamespace"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"avatarUrl"},arguments:[],directives:[]}]}},{kind:"Field",name:{kind:"Name",value:"pageInfo"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"PageInfo"},directives:[]}]}}]}}]}}],loc:{start:0,end:457}};i.loc.source={body:'#import "~/graphql_shared/fragments/pageInfo.fragment.graphql"\n\nquery getProjects(\n  $search: String = ""\n  $after: String = ""\n  $first: Int = null\n  $ids: [ID!] = null\n) {\n  projects(\n    search: $search\n    after: $after\n    first: $first\n    ids: $ids\n    membership: true\n    searchNamespaces: true\n    sort: "UPDATED_ASC"\n  ) {\n    nodes {\n      id\n      name\n      nameWithNamespace\n      avatarUrl\n    }\n    pageInfo {\n      ...PageInfo\n    }\n  }\n}\n',name:"GraphQL request",locationOffset:{line:1,column:1}};var a={};i.definitions=i.definitions.concat(t("xOIp").definitions.filter((function(e){if("FragmentDefinition"!==e.kind)return!0;var n=e.name.value;return!a[n]&&(a[n]=!0,!0)})));var r={};function o(e,n){for(var t=0;t<e.definitions.length;t++){var i=e.definitions[t];if(i.name&&i.name.value==n)return i}}i.definitions.forEach((function(e){if(e.name){var n=new Set;!function e(n,t){if("FragmentSpread"===n.kind)t.add(n.name.value);else if("VariableDefinition"===n.kind){var i=n.type;"NamedType"===i.kind&&t.add(i.name.value)}n.selectionSet&&n.selectionSet.selections.forEach((function(n){e(n,t)})),n.variableDefinitions&&n.variableDefinitions.forEach((function(n){e(n,t)})),n.definitions&&n.definitions.forEach((function(n){e(n,t)}))}(e,n),r[e.name.value]=n}})),e.exports=i,e.exports.getProjects=function(e,n){var t={kind:e.kind,definitions:[o(e,n)]};e.hasOwnProperty("loc")&&(t.loc=e.loc);var i=r[n]||new Set,a=new Set,s=new Set;for(i.forEach((function(e){s.add(e)}));s.size>0;){var l=s;s=new Set,l.forEach((function(e){a.has(e)||(a.add(e),(r[e]||new Set).forEach((function(e){s.add(e)})))}))}return a.forEach((function(n){var i=o(e,n);i&&t.definitions.push(i)})),t}(i,"getProjects")},xOIp:function(e,n){var t={kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"PageInfo"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"PageInfo"}},directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"hasNextPage"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"hasPreviousPage"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"startCursor"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"endCursor"},arguments:[],directives:[]}]}}],loc:{start:0,end:92}};t.loc.source={body:"fragment PageInfo on PageInfo {\n  hasNextPage\n  hasPreviousPage\n  startCursor\n  endCursor\n}\n",name:"GraphQL request",locationOffset:{line:1,column:1}};e.exports=t}}]);
//# sourceMappingURL=463.949f09af.chunk.js.map