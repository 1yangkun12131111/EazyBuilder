(this.webpackJsonp=this.webpackJsonp||[]).push([[166],{"+FvQ":function(e,t,n){"use strict";n.d(t,"b",(function(){return r})),n.d(t,"a",(function(){return o})),n.d(t,"c",(function(){return s})),n.d(t,"d",(function(){return c}));var i=n("04nr");const r=function(e){return{endpoint:e.notesData.draftsPath,data:e}},o=function(e){return{endpoint:e.notesData.draftsPath,data:Object(i.i)(e)}},s=function(e,t){return e[t]?e[t].line_code:""},c=function(e,t){if(null===t)return!0;if("left"===t||"right"===t){const n="left"===t?"right":"left",i=e[t]&&e[t].line_code||"",r=e[n]&&e[n].line_code||"";if(i!==r||"left"===t&&i===r)return!0}return!1}},Gs6c:function(e,t,n){"use strict";n("jaBk");var i=n("2ibD"),r=n("z/4y");t.a=new class extends r.a{constructor(){super(),this.pendingRequests={}}override(e,t){this.internalStorage[e]=t}retrieve(e,t){var n=this;if(this.hasData(e)&&!t)return Promise.resolve(this.get(e));let r=this.pendingRequests[e];return r||(r=i.a.get(e).then((function(t){let{data:i}=t;n.internalStorage[e]=i,delete n.pendingRequests[e]})).catch((function(t){const i=new Error("".concat(e,": ").concat(t.message));throw i.textStatus=t.message,delete n.pendingRequests[e],i})),this.pendingRequests[e]=r),r.then((function(){return n.get(e)}))}}},T22c:function(e,t,n){"use strict";var i=n("7xOh");t.a=Object(i.a)()},aTm7:function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var i=n("06tH"),r=n.n(i),o=n("pIt4");function s(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];const t=r.a.get(o.q);return t?t===o.x:e}},i3g2:function(e,t,n){"use strict";n.d(t,"c",(function(){return u})),n.d(t,"a",(function(){return f})),n.d(t,"e",(function(){return a})),n.d(t,"d",(function(){return l})),n.d(t,"b",(function(){return d}));n("dHQd"),n("yoDG"),n("tWNI"),n("8d6S"),n("VwWG"),n("IYHS"),n("MViX"),n("GDOA"),n("a0mT"),n("ta8/"),n("IKCR"),n("nmTw"),n("W2kU"),n("58fc"),n("Rhav"),n("eppl"),n("orcL");function i(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,i)}return n}function r(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?i(Object(n),!0).forEach((function(t){o(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):i(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function o(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function s(e){return"".concat(e,"-file-reviews")}function c(e,t){const n=e[t.file_identifier_hash];return!!((null==t?void 0:t.id)&&(null==n?void 0:n.length))&&new Set(n).has(t.id)}function u(e,t){return e.reduce((function(e,n){return r(r({},e),{},{[n.id]:c(t,n)})}),{})}function f(e){const t=localStorage.getItem(s(e));let n={};if(t)try{n=JSON.parse(t)}catch(e){n={}}return n}function a(e,t){return localStorage.setItem(s(e),JSON.stringify(t)),t}function l(e){return Boolean(e.id)&&Boolean(e.file_identifier_hash)}function d(e,t){let n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];const i=r({},e||{}),o=i;let s;return l(t)&&(s=new Set(i[t.file_identifier_hash]||[]),n?s.add(t.id):s.delete(t.id),o[t.file_identifier_hash]=Array.from(s),0===o[t.file_identifier_hash].length&&delete o[t.file_identifier_hash]),o}},"rrF/":function(e,t,n){e.exports=function(){return new Worker(n.p+"tree_worker.9e6d2455.worker.js")}},wnC9:function(e,t,n){"use strict";n.r(t),n.d(t,"createStore",(function(){return mn}));var i={};n.r(i),n.d(i,"saveDraft",(function(){return F})),n.d(i,"addDraftToDiscussion",(function(){return I})),n.d(i,"createNewDraft",(function(){return S})),n.d(i,"deleteDraft",(function(){return T})),n.d(i,"fetchDrafts",(function(){return w})),n.d(i,"publishSingleDraft",(function(){return j})),n.d(i,"publishReview",(function(){return R})),n.d(i,"updateDiscussionsAfterPublish",(function(){return P})),n.d(i,"updateDraft",(function(){return L})),n.d(i,"scrollToDraft",(function(){return y})),n.d(i,"expandAllDiscussions",(function(){return C})),n.d(i,"toggleResolveDiscussion",(function(){return A}));var r={};n.r(r),n.d(r,"draftsCount",(function(){return H})),n.d(r,"getNotesData",(function(){return U})),n.d(r,"hasDrafts",(function(){return B})),n.d(r,"draftsPerDiscussionId",(function(){return M})),n.d(r,"draftsPerFileHashAndLine",(function(){return x})),n.d(r,"shouldRenderDraftRow",(function(){return V})),n.d(r,"shouldRenderParallelDraftRow",(function(){return G})),n.d(r,"hasParallelDraftLeft",(function(){return W})),n.d(r,"hasParallelDraftRight",(function(){return q})),n.d(r,"shouldRenderDraftRowInDiscussion",(function(){return k})),n.d(r,"draftForDiscussion",(function(){return Q})),n.d(r,"draftForLine",(function(){return J})),n.d(r,"draftsForFile",(function(){return $})),n.d(r,"isPublishingDraft",(function(){return K})),n.d(r,"sortedDrafts",(function(){return Y}));var o={};n.r(o),n.d(o,"setBaseConfig",(function(){return Te})),n.d(o,"fetchDiffFilesBatch",(function(){return we})),n.d(o,"fetchDiffFilesMeta",(function(){return je})),n.d(o,"fetchCoverageFiles",(function(){return Re})),n.d(o,"setHighlightedRow",(function(){return Pe})),n.d(o,"assignDiscussionsToDiff",(function(){return Le})),n.d(o,"removeDiscussionsFromDiff",(function(){return ye})),n.d(o,"toggleLineDiscussions",(function(){return Ce})),n.d(o,"renderFileForDiscussionId",(function(){return Ae})),n.d(o,"startRenderDiffsQueue",(function(){return Ne})),n.d(o,"setRenderIt",(function(){return He})),n.d(o,"setInlineDiffViewType",(function(){return Ue})),n.d(o,"setParallelDiffViewType",(function(){return Be})),n.d(o,"showCommentForm",(function(){return Me})),n.d(o,"cancelCommentForm",(function(){return xe})),n.d(o,"loadMoreLines",(function(){return Ve})),n.d(o,"scrollToLineIfNeededInline",(function(){return Ge})),n.d(o,"scrollToLineIfNeededParallel",(function(){return We})),n.d(o,"loadCollapsedDiff",(function(){return qe})),n.d(o,"toggleFileDiscussions",(function(){return ke})),n.d(o,"toggleFileDiscussionWrappers",(function(){return Qe})),n.d(o,"saveDiffDiscussion",(function(){return Je})),n.d(o,"toggleTreeOpen",(function(){return $e})),n.d(o,"toggleActiveFileByHash",(function(){return Ke})),n.d(o,"scrollToFile",(function(){return Ye})),n.d(o,"setShowTreeList",(function(){return Xe})),n.d(o,"openDiffFileCommentForm",(function(){return ze})),n.d(o,"closeDiffFileCommentForm",(function(){return Ze})),n.d(o,"setRenderTreeList",(function(){return et})),n.d(o,"setShowWhitespace",(function(){return tt})),n.d(o,"toggleFileFinder",(function(){return nt})),n.d(o,"cacheTreeListWidth",(function(){return it})),n.d(o,"receiveFullDiffError",(function(){return rt})),n.d(o,"setExpandedDiffLines",(function(){return ot})),n.d(o,"fetchFullDiff",(function(){return st})),n.d(o,"toggleFullDiff",(function(){return ct})),n.d(o,"switchToFullDiffFromRenamedFile",(function(){return ut})),n.d(o,"setFileCollapsedByUser",(function(){return ft})),n.d(o,"setSuggestPopoverDismissed",(function(){return at})),n.d(o,"changeCurrentCommit",(function(){return lt})),n.d(o,"moveToNeighboringCommit",(function(){return dt})),n.d(o,"setCurrentDiffFileIdFromNote",(function(){return _t})),n.d(o,"navigateToDiffFileIndex",(function(){return ht})),n.d(o,"setFileByFile",(function(){return mt})),n.d(o,"reviewFile",(function(){return pt}));var s={};n.r(s),n.d(s,"selectedTargetIndex",(function(){return At})),n.d(s,"selectedSourceIndex",(function(){return Nt})),n.d(s,"selectedContextCommitsDiffs",(function(){return Ht})),n.d(s,"diffCompareDropdownTargetVersions",(function(){return Ut})),n.d(s,"diffCompareDropdownSourceVersions",(function(){return Bt})),n.d(s,"isParallelView",(function(){return Gt})),n.d(s,"isInlineView",(function(){return Wt})),n.d(s,"whichCollapsedTypes",(function(){return qt})),n.d(s,"commitId",(function(){return kt})),n.d(s,"diffHasAllExpandedDiscussions",(function(){return Qt})),n.d(s,"diffHasAllCollapsedDiscussions",(function(){return Jt})),n.d(s,"diffHasExpandedDiscussions",(function(){return $t})),n.d(s,"diffHasDiscussions",(function(){return Kt})),n.d(s,"getDiffFileDiscussions",(function(){return Yt})),n.d(s,"getDiffFileByHash",(function(){return Xt})),n.d(s,"flatBlobsList",(function(){return zt})),n.d(s,"allBlobs",(function(){return Zt})),n.d(s,"getCommentFormForDiffFile",(function(){return en})),n.d(s,"fileLineCoverage",(function(){return tn})),n.d(s,"currentDiffIndex",(function(){return nn})),n.d(s,"diffLines",(function(){return rn})),n.d(s,"suggestionCommitMessage",(function(){return on})),n.d(s,"isVirtualScrollingEnabled",(function(){return sn}));var c={};n.r(c),n.d(c,"setActiveTab",(function(){return fn})),n.d(c,"setEndpoints",(function(){return an})),n.d(c,"setMrMetadata",(function(){return ln})),n.d(c,"fetchMrMetadata",(function(){return dn}));var u=n("jB52"),f=n("yi8e"),a=(n("jaBk"),n("Q33P")),l=n.n(a),d=n("XRO8"),_=n("NmEs"),h=n("/lV4");var m=n("2ibD");function p(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,i)}return n}function E(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?p(Object(n),!0).forEach((function(t){g(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):p(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function g(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var O={createNewDraft(e,t){const n=E(E({},t),{},{draft_note:t.note});return delete n.note,m.a.post(e,n)},deleteDraft:(e,t)=>m.a.delete("".concat(e,"/").concat(t)),publishDraft:(e,t)=>m.a.post(e,{id:t}),addDraftToDiscussion:(e,t)=>m.a.post(e,t),fetchDrafts:e=>m.a.get(e),publish:e=>m.a.post(e),discard:e=>m.a.delete(e),update(e,t){let{draftId:n,note:i,resolveDiscussion:r,position:o}=t;return m.a.put("".concat(e,"/").concat(n),{draft_note:{note:i,resolve_discussion:r,position:o}})}};function D(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,i)}return n}function b(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?D(Object(n),!0).forEach((function(t){v(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):D(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function v(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}const F=function(e,t){let{dispatch:n}=e;return n("saveNote",b(b({},t),{},{isDraft:!0}),{root:!0})},I=function(e,t){let{commit:n}=e,{endpoint:i,data:r}=t;return O.addDraftToDiscussion(i,r).then((function(e){return e.data})).then((function(e){return n("ADD_NEW_DRAFT",e),e})).catch((function(){Object(d.c)(Object(h.a)("An error occurred adding a draft to the thread."))}))},S=function(e,t){let{commit:n}=e,{endpoint:i,data:r}=t;return O.createNewDraft(i,r).then((function(e){return e.data})).then((function(e){return n("ADD_NEW_DRAFT",e),e})).catch((function(){Object(d.c)(Object(h.a)("An error occurred adding a new draft."))}))},T=function(e,t){let{commit:n,getters:i}=e;return O.deleteDraft(i.getNotesData.draftsPath,t.id).then((function(){n("DELETE_DRAFT",t.id)})).catch((function(){return Object(d.c)(Object(h.a)("An error occurred while deleting the comment"))}))},w=function(e){let{commit:t,getters:n}=e;return O.fetchDrafts(n.getNotesData.draftsPath).then((function(e){return e.data})).then((function(e){return t("SET_BATCH_COMMENTS_DRAFTS",e)})).catch((function(){return Object(d.c)(Object(h.a)("An error occurred while fetching pending comments"))}))},j=function(e,t){let{commit:n,dispatch:i,getters:r}=e;n("REQUEST_PUBLISH_DRAFT",t),O.publishDraft(r.getNotesData.draftsPublishPath,t).then((function(){return i("updateDiscussionsAfterPublish")})).then((function(){return n("RECEIVE_PUBLISH_DRAFT_SUCCESS",t)})).catch((function(){return n("RECEIVE_PUBLISH_DRAFT_ERROR",t)}))},R=function(e){let{commit:t,dispatch:n,getters:i}=e;return t("REQUEST_PUBLISH_REVIEW"),O.publish(i.getNotesData.draftsPublishPath).then((function(){return n("updateDiscussionsAfterPublish")})).then((function(){return t("RECEIVE_PUBLISH_REVIEW_SUCCESS")})).catch((function(){return t("RECEIVE_PUBLISH_REVIEW_ERROR")}))},P=async function(e){var t,n;let{dispatch:i,getters:r,rootGetters:o}=e;(null===(t=window.gon)||void 0===t?void 0:null===(n=t.features)||void 0===n?void 0:n.paginatedNotes)?(await i("stopPolling",null,{root:!0}),await i("fetchData",null,{root:!0}),await i("restartPolling",null,{root:!0})):await i("fetchDiscussions",{path:r.getNotesData.discussionsPath},{root:!0}),i("diffs/assignDiscussionsToDiff",o.discussionsStructuredByLineCode,{root:!0})},L=function(e,t){let{commit:n,getters:i}=e,{note:r,noteText:o,resolveDiscussion:s,position:c,callback:u}=t;const f={draftId:r.id,note:o,resolveDiscussion:s};return l()(c)||(f.position=JSON.stringify(c)),O.update(i.getNotesData.draftsPath,f).then((function(e){return e.data})).then((function(e){return n("RECEIVE_DRAFT_UPDATE_SUCCESS",e)})).then(u).catch((function(){return Object(d.c)(Object(h.a)("An error occurred while updating the comment"))}))},y=function(e,t){let{dispatch:n,rootGetters:i}=e;const r=t.discussion_id&&i.getDiscussion(t.discussion_id),o=t.file_hash||r&&r.diff_discussion?"diffs":"show",s="diffs"===o?"diffs":"notes",c="note_".concat(t.id),u=document.querySelector("#".concat(s," #").concat(c));window.location.hash=c,window.mrTabs.currentAction!==o&&window.mrTabs.tabShown(o),r&&n("expandDiscussion",{discussionId:r.id},{root:!0}),u&&setTimeout((function(){return Object(_.Q)(u.closest(".draft-note-component"))}))},C=function(e){let{dispatch:t,state:n}=e;return n.drafts.filter((function(e){return e.discussion_id})).forEach((function(e){t("expandDiscussion",{discussionId:e.discussion_id},{root:!0})}))},A=function(e,t){let{commit:n}=e;n("TOGGLE_RESOLVE_DISCUSSION",t)};n("orcL");var N=n("+FvQ");const H=function(e){return e.drafts.length},U=function(e,t,n,i){return i.getNotesData},B=function(e){return e.drafts.length>0},M=function(e){return e.drafts.reduce((function(e,t){return t.discussion_id&&(e[t.discussion_id]=t),e}),{})},x=function(e){return e.drafts.reduce((function(e,t){return t.file_hash&&(e[t.file_hash]||(e[t.file_hash]={}),e[t.file_hash][t.line_code]=t),e}),{})},V=function(e,t){return function(e,n){return Boolean(e in t.draftsPerFileHashAndLine&&t.draftsPerFileHashAndLine[e][n.line_code])}},G=function(e,t){return function(e,n){const i=t.draftsPerFileHashAndLine[e],[r,o]=[Object(N.c)(n,"left"),Object(N.c)(n,"right")];return!!i&&Boolean(i[r]||i[o])}},W=function(e,t){return function(e,n){const i=t.draftsPerFileHashAndLine[e],r=Object(N.c)(n,"left");return!!i&&Boolean(i[r])}},q=function(e,t){return function(e,n){const i=t.draftsPerFileHashAndLine[e],r=Object(N.c)(n,"left");return!!i&&Boolean(i[r])}},k=function(e,t){return function(e){return void 0!==t.draftsPerDiscussionId[e]}},Q=function(e,t){return function(e){return t.draftsPerDiscussionId[e]||{}}},J=function(e,t){return function(e,n){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;const r=t.draftsPerFileHashAndLine[e],o=null!==i?Object(N.c)(n,i):n.line_code;if(r){const e=r[o];if(e&&Object(N.d)(n,i))return e}return{}}},$=function(e){return function(t){return e.drafts.filter((function(e){return e.file_hash===t}))}},K=function(e){return function(t){return-1!==e.currentlyPublishingDrafts.indexOf(t)}},Y=function(e){return[...e.drafts].sort((function(e,t){return e.id>t.id}))};function X(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,i)}return n}function z(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?X(Object(n),!0).forEach((function(t){Z(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):X(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function Z(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}const ee=function(e){return z(z({},e),{},{isDraft:!0})};var te={ADD_NEW_DRAFT(e,t){e.drafts.push(ee(t))},DELETE_DRAFT(e,t){e.drafts=e.drafts.filter((function(e){return e.id!==t}))},SET_BATCH_COMMENTS_DRAFTS(e,t){e.drafts=t.map(ee)},REQUEST_PUBLISH_DRAFT(e,t){e.currentlyPublishingDrafts.push(t)},RECEIVE_PUBLISH_DRAFT_SUCCESS(e,t){e.currentlyPublishingDrafts=e.currentlyPublishingDrafts.filter((function(e){return e!==t})),e.drafts=e.drafts.filter((function(e){return e.id!==t}))},RECEIVE_PUBLISH_DRAFT_ERROR(e,t){e.currentlyPublishingDrafts=e.currentlyPublishingDrafts.filter((function(e){return e!==t}))},REQUEST_PUBLISH_REVIEW(e){e.isPublishing=!0},RECEIVE_PUBLISH_REVIEW_SUCCESS(e){e.isPublishing=!1,e.drafts=[]},RECEIVE_PUBLISH_REVIEW_ERROR(e){e.isPublishing=!1},RECEIVE_DRAFT_UPDATE_SUCCESS(e,t){const n=e.drafts.findIndex((function(e){return e.id===t.id}));n>=0&&e.drafts.splice(n,1,ee(t))},TOGGLE_RESOLVE_DISCUSSION(e,t){e.drafts=e.drafts.map((function(e){return e.id===t?z(z({},e),{},{resolve_discussion:!e.resolve_discussion}):e}))}},ne=(n("EWC9"),n("Ag57"),n("GzNv"),n("S26F"),n("pBsb"),n("dHQd"),n("yoDG"),n("tWNI"),n("8d6S"),n("VwWG"),n("IYHS"),n("MViX"),n("GDOA"),n("a0mT"),n("ta8/"),n("IKCR"),n("nmTw"),n("W2kU"),n("58fc"),n("Rhav"),n("eppl"),n("06tH")),ie=n.n(ne),re=n("qPgm"),oe=n("BAGK"),se=n("QwBj"),ce=n("hqF9"),ue=n("3twG"),fe=n("J7NB"),ae=n("pIt4"),le=n("T22c"),de=n("Gtn5"),_e=n("i3g2"),he=n("LlB7"),me=n("rrF/"),pe=n.n(me);const Ee="SET_BASE_CONFIG",ge="SET_DIFF_FILES",Oe="SET_MR_FILE_REVIEWS",De="SET_CURRENT_VIEW_DIFF_FILE_LINES",be="SET_DIFF_FILE_VIEWER";var ve=n("04nr");function Fe(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,i)}return n}function Ie(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Fe(Object(n),!0).forEach((function(t){Se(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Fe(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function Se(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}const Te=function(e,t){let{commit:n}=e;const{endpoint:i,endpointMetadata:r,endpointBatch:o,endpointCoverage:s,endpointUpdateUser:c,projectPath:u,dismissEndpoint:f,showSuggestPopover:a,defaultSuggestionCommitMessage:l,viewDiffsFileByFile:d,mrReviews:_}=t;n(Ee,{endpoint:i,endpointMetadata:r,endpointBatch:o,endpointCoverage:s,endpointUpdateUser:c,projectPath:u,dismissEndpoint:f,showSuggestPopover:a,defaultSuggestionCommitMessage:l,viewDiffsFileByFile:d,mrReviews:_})},we=function(e){var t,i,r,o;let{commit:s,state:c,dispatch:u}=e;const f=null===(t=window.gon)||void 0===t?void 0:null===(i=t.features)||void 0===i?void 0:i.diffsGradualLoad;let a=ae.m,l=1.4;f&&(a=c.viewDiffsFileByFile?1:5);const d=f?0:1,h=null===(r=window)||void 0===r?void 0:null===(o=r.location)||void 0===o?void 0:o.hash,p=0===h.indexOf("#note"),E={w:c.showWhitespace?"0":"1",view:"inline"};let g=0;s("SET_BATCH_LOADING",!0),s("SET_RETRIEVING_BATCHES",!0),le.a.$emit(ae.C);return function e(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:d;return m.a.get(Object(ue.q)(Ie(Ie({},E),{},{page:t,per_page:a}),c.endpointBatch)).then((function(e){let{data:{pagination:i,diff_files:r}}=e;var o;if(g+=r.length,s("SET_DIFF_DATA_BATCH",{diff_files:r}),s("SET_BATCH_LOADING",!1),p||c.currentDiffFileId||s("VIEW_DIFF_FILE",r[0].file_hash),p&&u("setCurrentDiffFileIdFromNote",h.split("_").pop()),f&&(g===i.total_pages||null===i.total_pages)||!f&&!i.next_page)return s("SET_RETRIEVING_BATCHES",!1),!c.currentDiffFileId||c.diffFiles.some((function(e){return e.file_hash===c.currentDiffFileId}))||p||s("VIEW_DIFF_FILE",c.diffFiles[0].file_hash),(null===(o=c.diffFiles)||void 0===o?void 0:o.length)&&Promise.all([n.e(140),n.e(474)]).then(n.bind(null,"uOOt")).then((function(e){return e.default({blobs:c.diffFiles.filter((function(e){return e.code_navigation_path})).map((function(e){return{path:e.new_path,codeNavigationPath:e.code_navigation_path}})),definitionPathPrefix:c.definitionPathPrefix})})),null;if(f){const e=t+a;return a=Math.min(Math.ceil(a*l),30),l=Math.min(l+.2,2),e}return i.next_page})).then((function(t){return u("startRenderDiffsQueue"),t?e(t):null})).catch((function(){return s("SET_RETRIEVING_BATCHES",!1)}))}().then(_.t).catch((function(){return null}))},je=function(e){let{commit:t,state:n}=e;const i=new pe.a;return t("SET_LOADING",!0),le.a.$emit(ae.E),i.addEventListener("message",(function(e){let{data:n}=e;t("SET_TREE_DATA",n),le.a.$emit(ae.D),i.terminate()})),m.a.get(Object(ue.q)({view:"inline"},n.endpointMetadata)).then((function(e){let{data:n}=e;const r=Ie({},n);return delete r.diff_files,t("SET_LOADING",!1),t("SET_MERGE_REQUEST_DIFFS",n.merge_request_diffs||[]),t("SET_DIFF_METADATA",r),i.postMessage(n.diff_files),n})).catch((function(){return i.terminate()}))},Re=function(e){let{commit:t,state:n}=e;const i=new ce.a({resource:{getCoverageReports:function(e){return m.a.get(e)}},data:n.endpointCoverage,method:"getCoverageReports",successCallback:function(e){let{status:n,data:r}=e;n===se.a.OK&&(t("SET_COVERAGE_DATA",r),i.stop())},errorCallback:function(){return Object(d.c)(Object(h.a)("Something went wrong on our end. Please try again!"))}});i.makeRequest()},Pe=function(e,t){let{commit:n}=e;const i=t.split("_")[0];n("SET_HIGHLIGHTED_ROW",t),n("VIEW_DIFF_FILE",i)},Le=function(e){var t,n;let{commit:i,state:r,rootState:o,dispatch:s}=e,c=arguments.length>1&&void 0!==arguments[1]?arguments[1]:o.notes.discussions;const f=null===(t=window)||void 0===t?void 0:null===(n=t.location)||void 0===n?void 0:n.hash,a=0===f.indexOf("#note"),l=Object(ve.h)(r.diffFiles),d=Object(ue.f)();c.filter((function(e){return e.diff_discussion})).forEach((function(e){i("SET_LINE_DISCUSSIONS_FOR_FILE",{discussion:e,diffPositionByLineCode:l,hash:d})})),a&&s("setCurrentDiffFileIdFromNote",f.split("_").pop()),u.default.nextTick((function(){fe.a.$emit("scrollToDiscussion")}))},ye=function(e,t){let{commit:n}=e;const{file_hash:i,line_code:r,id:o}=t;n("REMOVE_LINE_DISCUSSIONS_FOR_FILE",{fileHash:i,lineCode:r,id:o})},Ce=function(e,t){let{commit:n}=e;n("TOGGLE_LINE_DISCUSSIONS",t)},Ae=function(e,t){let{commit:n,rootState:i,state:r}=e;const o=i.notes.discussions.find((function(e){return e.id===t}));if(o&&o.diff_file){const e=r.diffFiles.find((function(e){return e.file_hash===o.diff_file.file_hash}));e&&(e.renderIt||n("RENDER_FILE",e),e.viewer.automaticallyCollapsed?(fe.a.$emit("loadCollapsedDiff/".concat(e.file_hash)),Object(_.Q)(document.getElementById(e.file_hash))):e.viewer.manuallyCollapsed?(n("SET_FILE_COLLAPSED",{filePath:e.file_path,collapsed:!1,trigger:ae.p}),fe.a.$emit("scrollToDiscussion")):fe.a.$emit("scrollToDiscussion"))}},Ne=function(e){let{state:t,commit:n}=e;const i=t.diffFiles.filter((function(e){return!e.renderIt&&e.viewer&&(!Object(de.c)(e)||e.viewer.name!==oe.v.text)}));let r=0;i.length&&function e(){const t=i[r];if(t){let i=0;r+=1,n("RENDER_FILE",t),function t(){return requestIdleCallback((function(n){n.timeRemaining()>=5||i>4?e():(t(),i+=1)}))}()}}()},He=function(e,t){let{commit:n}=e;return n("RENDER_FILE",t)},Ue=function(e){var t,n;let{commit:i}=e;i("SET_DIFF_VIEW_TYPE",ae.J),ie.a.set(ae.w,ae.J);const r=Object(ue.q)({view:ae.J},window.location.href);Object(_.u)(r),(null===(t=window.gon)||void 0===t?void 0:null===(n=t.features)||void 0===n?void 0:n.diffSettingsUsageData)&&(re.a.trackRedisHllUserEvent(ae.mb),re.a.trackRedisHllUserEvent(ae.qb))},Be=function(e){var t,n;let{commit:i}=e;i("SET_DIFF_VIEW_TYPE",ae.eb),ie.a.set(ae.w,ae.eb);const r=Object(ue.q)({view:ae.eb},window.location.href);Object(_.u)(r),(null===(t=window.gon)||void 0===t?void 0:null===(n=t.features)||void 0===n?void 0:n.diffSettingsUsageData)&&(re.a.trackRedisHllUserEvent(ae.mb),re.a.trackRedisHllUserEvent(ae.rb))},Me=function(e,t){let{commit:n}=e,{lineCode:i,fileHash:r}=t;n("TOGGLE_LINE_HAS_FORM",{lineCode:i,fileHash:r,hasForm:!0})},xe=function(e,t){let{commit:n}=e,{lineCode:i,fileHash:r}=t;n("TOGGLE_LINE_HAS_FORM",{lineCode:i,fileHash:r,hasForm:!1})},Ve=function(e,t){let{commit:n}=e;const{endpoint:i,params:r,lineNumbers:o,fileHash:s,isExpandDown:c,nextLineNumbers:u}=t;return r.from_merge_request=!0,m.a.get(i,{params:r}).then((function(e){const t=e.data||[];n("ADD_CONTEXT_LINES",{lineNumbers:o,contextLines:t,params:r,fileHash:s,isExpandDown:c,nextLineNumbers:u})}))},Ge=function(e,t){const n=Object(ue.f)();n&&t.line_code===n&&Object(_.t)()},We=function(e,t){const n=Object(ue.f)();n&&(t.left&&t.left.line_code===n||t.right&&t.right.line_code===n)&&Object(_.t)()},qe=function(e,t){let{commit:n,getters:i,state:r}=e;return m.a.get(t.load_collapsed_diff_url,{params:{commit_id:i.commitId,w:r.showWhitespace?"0":"1"}}).then((function(e){n("ADD_COLLAPSED_DIFFS",{file:t,data:e.data})}))},ke=function(e,t){let{getters:n,dispatch:i}=e;const r=n.getDiffFileDiscussions(t),o=n.diffHasAllExpandedDiscussions(t),s=n.diffHasAllCollapsedDiscussions(t);r.forEach((function(e){const t={discussionId:e.id};o?i("collapseDiscussion",t,{root:!0}):!s&&(o||s||e.expanded)||i("expandDiscussion",t,{root:!0})}))},Qe=function(e,t){let{commit:n}=e;const i=Object(ve.c)(t),r=new Set;t[ae.I].filter((function(e){return Boolean(null==e?void 0:e.discussions.length)})).forEach((function(e){return r.add(e.line_code)})),r.size&&Array.from(r).forEach((function(e){n("TOGGLE_LINE_DISCUSSIONS",{fileHash:t.file_hash,expanded:!i,lineCode:e})}))},Je=function(e,t){let{state:n,dispatch:i}=e,{note:r,formData:o}=t;const s=Object(ve.j)(Ie({commit:n.commit,note:r},o));return i("saveNote",s,{root:!0}).then((function(e){return i("updateDiscussion",e.discussion,{root:!0})})).then((function(e){return i("assignDiscussionsToDiff",[e])})).then((function(){return i("updateResolvableDiscussionsCounts",null,{root:!0})})).then((function(){return i("closeDiffFileCommentForm",o.diffFile.file_hash)})).catch((function(){return Object(d.c)(Object(h.e)("MergeRequests|Saving the comment failed"))}))},$e=function(e,t){let{commit:n}=e;n("TOGGLE_FOLDER_OPEN",t)},Ke=function(e,t){let{commit:n}=e;n("VIEW_DIFF_FILE",t)},Ye=function(e,t){let{state:n,commit:i}=e;if(!n.treeEntries[t])return;const{fileHash:r}=n.treeEntries[t];document.location.hash=r,i("VIEW_DIFF_FILE",r)},Xe=function(e,t){let{commit:n}=e,{showTreeList:i,saving:r=!0}=t;n("SET_SHOW_TREE_LIST",i),r&&localStorage.setItem(ae.W,i)},ze=function(e,t){let{commit:n,getters:i}=e;n(i.getCommentFormForDiffFile(t.fileHash)?"UPDATE_DIFF_FILE_COMMENT_FORM":"OPEN_DIFF_FILE_COMMENT_FORM",t)},Ze=function(e,t){let{commit:n}=e;n("CLOSE_DIFF_FILE_COMMENT_FORM",t)},et=function(e,t){var n,i;let{commit:r}=e;r("SET_RENDER_TREE_LIST",t),localStorage.setItem(ae.Db,t),(null===(n=window.gon)||void 0===n?void 0:null===(i=n.features)||void 0===i?void 0:i.diffSettingsUsageData)&&(re.a.trackRedisHllUserEvent(ae.nb),t?re.a.trackRedisHllUserEvent(ae.tb):re.a.trackRedisHllUserEvent(ae.sb))},tt=function(e,t){var n,i;let{commit:r}=e,{showWhitespace:o,pushState:s=!1}=t;r("SET_SHOW_WHITESPACE",o);const c=o?ae.gb:ae.ab;ie.a.set(ae.y,c),s&&Object(_.u)(Object(ue.q)({w:c},window.location.href)),fe.a.$emit("refetchDiffData"),(null===(n=window.gon)||void 0===n?void 0:null===(i=n.features)||void 0===i?void 0:i.diffSettingsUsageData)&&(re.a.trackRedisHllUserEvent(ae.pb),o?re.a.trackRedisHllUserEvent(ae.xb):re.a.trackRedisHllUserEvent(ae.wb))},nt=function(e,t){let{commit:n}=e;n("TOGGLE_FILE_FINDER_VISIBLE",t)},it=function(e,t){localStorage.setItem(ae.Eb,t)},rt=function(e,t){let{commit:n}=e;n("RECEIVE_FULL_DIFF_ERROR",t),Object(d.c)(Object(h.e)("MergeRequest|Error loading full diff. Please try again."))},ot=function(e,t){let{commit:n}=e,{file:i,data:r}=t;const o=Object(ve.d)({diffLines:i[ae.I],typeKey:ae.Gb,oldLineKey:ae.bb,newLineKey:ae.X,data:r,mapLine:function(e){let{line:t,oldLine:n,newLine:r}=e;return Object.assign(t,{old_line:n,new_line:r,line_code:"".concat(i.file_hash,"_").concat(n,"_").concat(r)})}});if(o.length>ae.S){let e=ae.hb;n(De,{filePath:i.file_path,lines:o.slice(0,e)}),n("TOGGLE_DIFF_FILE_RENDERING_MORE",i.file_path);const t=function t(r){const s=e;for(;r.timeRemaining()>=ae.U&&e!==o.length&&e-s!==ae.R;){const t=o[e];t&&(n("ADD_CURRENT_VIEW_DIFF_FILE_LINES",{filePath:i.file_path,line:t}),e+=1)}e!==o.length?Object(ve.l)(t):n("TOGGLE_DIFF_FILE_RENDERING_MORE",i.file_path)};Object(ve.l)(t)}else n(De,{filePath:i.file_path,lines:o})},st=function(e,t){let{commit:n,dispatch:i}=e;return m.a.get(t.context_lines_path,{params:{full:!0,from_merge_request:!0}}).then((function(e){let{data:r}=e;n("RECEIVE_FULL_DIFF_SUCCESS",{filePath:t.file_path}),i("setExpandedDiffLines",{file:t,data:r})})).catch((function(){return i("receiveFullDiffError",t.file_path)}))},ct=function(e,t){let{dispatch:n,commit:i,getters:r,state:o}=e;const s=o.diffFiles.find((function(e){return e.file_path===t}));i("REQUEST_FULL_DIFF",t),s.isShowingFullFile?n("loadCollapsedDiff",s).then((function(){return n("assignDiscussionsToDiff",r.getDiffFileDiscussions(s))})).catch((function(){return n("receiveFullDiffError",t)})):n("fetchFullDiff",s)};function ut(e,t){let{commit:n,dispatch:i}=e,{diffFile:r}=t;return m.a.get(r.context_lines_path,{params:{full:!0,from_merge_request:!0}}).then((function(e){let{data:t}=e;const o=t.map((function(e,t){return Object(ve.p)({diffViewType:"inline",line:e,diffFile:r,index:t})}));n(be,{filePath:r.file_path,viewer:Ie(Ie({},r.alternate_viewer),{},{automaticallyCollapsed:!1,manuallyCollapsed:!1})}),n(De,{filePath:r.file_path,lines:o}),i("startRenderDiffsQueue")}))}const ft=function(e,t){let{commit:n}=e,{filePath:i,collapsed:r}=t;n("SET_FILE_COLLAPSED",{filePath:i,collapsed:r,trigger:ae.s})},at=function(e){let{commit:t,state:n}=e;return m.a.post(n.dismissEndpoint,{feature_name:"suggest_popover_dismissed"}).then((function(){t("SET_SHOW_SUGGEST_POPOVER")})).catch((function(){Object(d.c)(Object(h.e)("MergeRequest|Error dismissing suggestion popover. Please try again."))}))};function lt(e,t){let{dispatch:n,commit:i,state:r}=e,{commitId:o}=t;if(!o)return Promise.reject(new Error("`commitId` is a required argument"));if(!r.commit)return Promise.reject(new Error("`state` must already contain a valid `commit`"));const s=new RegExp(r.commit.id,"g");return i(ge,[]),i(Ee,Ie(Ie({},r),{},{endpoint:r.endpoint.replace(s,o),endpointBatch:r.endpointBatch.replace(s,o),endpointMetadata:r.endpointMetadata.replace(s,o)})),n("fetchDiffFilesMeta")}function dt(e,t){var n,i;let{dispatch:r,state:o}=e,{direction:s}=t;const c=null===(n=o.commit)||void 0===n?void 0:n.prev_commit_id,u=null===(i=o.commit)||void 0===i?void 0:i.next_commit_id,f=!o.isLoading&&u,a=!o.isLoading&&c;let l;"next"===s&&f?l=u:"previous"===s&&a&&(l=c),l&&r("changeCurrentCommit",{commitId:l})}const _t=function(e,t){var n;let{commit:i,state:r,rootGetters:o}=e;const s=o.notesById[t];if(!s)return;const c=null===(n=o.getDiscussion(s.discussion_id).diff_file)||void 0===n?void 0:n.file_hash;c&&r.diffFiles.some((function(e){return e.file_hash===c}))&&i("VIEW_DIFF_FILE",c)},ht=function(e,t){let{commit:n,state:i}=e;const r=i.diffFiles[t].file_hash;document.location.hash=r,n("VIEW_DIFF_FILE",r)},mt=function(e,t){var n,i;let{state:r,commit:o}=e,{fileByFile:s}=t;const c=s?ae.x:ae.v;return o("SET_FILE_BY_FILE",s),ie.a.set(ae.q,c),(null===(n=window.gon)||void 0===n?void 0:null===(i=n.features)||void 0===i?void 0:i.diffSettingsUsageData)&&(re.a.trackRedisHllUserEvent(ae.ob),s?re.a.trackRedisHllUserEvent(ae.vb):re.a.trackRedisHllUserEvent(ae.ub)),m.a.put(r.endpointUpdateUser,{view_diffs_file_by_file:s}).then((function(){}))};function pt(e,t){let{commit:n,state:i}=e,{file:r,reviewed:o=!0}=t;const{mrPath:s}=Object(he.a)({endpoint:r.load_collapsed_diff_url}),c=Object(_e.b)(i.mrReviews,r,o);Object(_e.e)(s,c),n(Oe,c)}var Et=n("aTm7");const gt=ie.a.get(ae.w),Ot=ae.J,Dt=Object(ue.g)("w")[0],bt=ie.a.get(ae.y);function vt(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,i)}return n}function Ft(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?vt(Object(n),!0).forEach((function(t){It(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):vt(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function It(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function St(e){Object.assign(e,{renderIt:!0})}var Tt={[Ee](e,t){const{endpoint:n,endpointMetadata:i,endpointBatch:r,endpointCoverage:o,endpointUpdateUser:s,projectPath:c,dismissEndpoint:u,showSuggestPopover:f,defaultSuggestionCommitMessage:a,viewDiffsFileByFile:l,mrReviews:d}=t;Object.assign(e,{endpoint:n,endpointMetadata:i,endpointBatch:r,endpointCoverage:o,endpointUpdateUser:s,projectPath:c,dismissEndpoint:u,showSuggestPopover:f,defaultSuggestionCommitMessage:a,viewDiffsFileByFile:l,mrReviews:d})},SET_LOADING(e,t){Object.assign(e,{isLoading:t})},SET_BATCH_LOADING(e,t){Object.assign(e,{isBatchLoading:t})},SET_RETRIEVING_BATCHES(e,t){Object.assign(e,{retrievingBatches:t})},[ge](e,t){!function(e,t){Object.assign(e,{diffFiles:t})}(e,t)},SET_DIFF_METADATA(e,t){Object.assign(e,Ft({},Object(_.h)(t)))},SET_DIFF_DATA_BATCH(e,t){e.diffFiles=Object(ve.o)({diff:t,priorFiles:e.diffFiles})},SET_COVERAGE_DATA(e,t){Object.assign(e,{coverageFiles:t})},RENDER_FILE(e,t){St(t)},SET_MERGE_REQUEST_DIFFS(e,t){Object.assign(e,{mergeRequestDiffs:t})},SET_DIFF_VIEW_TYPE(e,t){Object.assign(e,{diffViewType:t})},TOGGLE_LINE_HAS_FORM(e,t){let{lineCode:n,fileHash:i,hasForm:r}=t;const o=e.diffFiles.find((function(e){return e.file_hash===i}));o&&(o[ae.I].find((function(e){return e.line_code===n})).hasForm=r)},ADD_CONTEXT_LINES(e,t){const{lineNumbers:n,contextLines:i,fileHash:r,isExpandDown:o,nextLineNumbers:s}=t,{bottom:c}=t.params,u=Object(ve.e)(e.diffFiles,r);Object(ve.q)(u,n,c);const f=Object(ve.b)(i,n,c,o,s).map((function(e){const t="match"===e.type?"".concat(r,"_").concat(e.meta_data.old_pos,"_").concat(e.meta_data.new_pos,"_match"):e.line_code||"".concat(r,"_").concat(e.old_line,"_").concat(e.new_line);return Ft(Ft({},e),{},{line_code:t,discussions:e.discussions||[],hasForm:!1})}));Object(ve.a)({inlineLines:u[ae.I],contextLines:f,bottom:c,lineNumbers:n,isExpandDown:o})},ADD_COLLAPSED_DIFFS(e,t){let{file:n,data:i}=t;const r=Object(ve.o)({diff:i}),[o]=r.filter((function(e){return e.file_hash===n.file_hash})),s=e.diffFiles.find((function(e){return e.file_hash===n.file_hash}));Object.assign(s,Ft({},o))},SET_LINE_DISCUSSIONS_FOR_FILE(e,t){var n,i,r;let{discussion:o,diffPositionByLineCode:s,hash:c}=t;const{latestDiff:u}=e,f=null===(n=o.original_position)||void 0===n?void 0:null===(i=n.line_range)||void 0===i?void 0:null===(r=i.start)||void 0===r?void 0:r.line_code,a=[o.line_code,f,...o.line_codes||[]],l=o.diff_file.file_hash,d=function(e){return a.some((function(t){return e.line_code===t&&Object(ve.m)({discussion:o,diffPosition:s[e.line_code],latestDiff:u})}))};e.diffFiles.forEach((function(e){if(e.file_hash===l&&(e[ae.I].length&&e[ae.I].forEach((function(e){Object.assign(e,function(e){const t=e.discussions&&e.discussions.some((function(e){return e.notes&&e.notes.find((function(e){return c==="note_".concat(e.id)}))}));return Ft(Ft({},e),{},{discussionsExpanded:!(!e.discussions||!e.discussions.length)&&(e.discussions.some((function(e){return!e.resolved}))||t)})}(d(e)?function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:function(){return!0};return Ft(Ft({},e),{},{discussions:t()?e.discussions&&e.discussions.filter((function(){return!e.discussions.some((function(e){let{id:t}=e;return o.id===t}))})).concat(d(e)?o:e.discussions):[]})}(e):e))})),!e[ae.I].length)){const t=(e.discussions||[]).filter((function(e){return e.id!==o.id})).concat(o);Object.assign(e,{discussions:t})}}))},REMOVE_LINE_DISCUSSIONS_FOR_FILE(e,t){let{fileHash:n,lineCode:i}=t;const r=e.diffFiles.find((function(e){return e.file_hash===n}));r&&(Object(ve.s)(r,i,(function(e){return Object.assign(e,{discussions:e.discussions.filter((function(e){return e.notes.length}))})})),r.discussions&&r.discussions.length&&(r.discussions=r.discussions.filter((function(e){return e.notes.length}))))},TOGGLE_LINE_DISCUSSIONS(e,t){let{fileHash:n,lineCode:i,expanded:r}=t;const o=e.diffFiles.find((function(e){return e.file_hash===n}));Object(ve.s)(o,i,(function(e){Object.assign(e,{discussionsExpanded:r})}))},TOGGLE_FOLDER_OPEN(e,t){e.treeEntries[t].opened=!e.treeEntries[t].opened},SET_SHOW_TREE_LIST(e,t){e.showTreeList=t},VIEW_DIFF_FILE(e,t){e.currentDiffFileId=t,u.default.set(e.viewedDiffFileIds,t,!0)},OPEN_DIFF_FILE_COMMENT_FORM(e,t){e.commentForms.push(Ft({},t))},UPDATE_DIFF_FILE_COMMENT_FORM(e,t){const{fileHash:n}=t;e.commentForms=e.commentForms.map((function(e){return e.fileHash===n?Ft({},t):e}))},CLOSE_DIFF_FILE_COMMENT_FORM(e,t){e.commentForms=e.commentForms.filter((function(e){return e.fileHash!==t}))},SET_HIGHLIGHTED_ROW(e,t){e.highlightedRow=t},SET_TREE_DATA(e,t){let{treeEntries:n,tree:i}=t;e.treeEntries=n,e.tree=i,e.isTreeLoaded=!0},SET_RENDER_TREE_LIST(e,t){e.renderTreeList=t},SET_SHOW_WHITESPACE(e,t){e.showWhitespace=t,e.diffFiles=[]},TOGGLE_FILE_FINDER_VISIBLE(e,t){e.fileFinderVisible=t},REQUEST_FULL_DIFF(e,t){Object(ve.e)(e.diffFiles,t,"file_path").isLoadingFullFile=!0},RECEIVE_FULL_DIFF_ERROR(e,t){Object(ve.e)(e.diffFiles,t,"file_path").isLoadingFullFile=!1},RECEIVE_FULL_DIFF_SUCCESS(e,t){let{filePath:n}=t;const i=Object(ve.e)(e.diffFiles,n,"file_path");i.isShowingFullFile=!0,i.isLoadingFullFile=!1},SET_FILE_COLLAPSED(e,t){let{filePath:n,collapsed:i,trigger:r=ae.p}=t;const o=e.diffFiles.find((function(e){return e.file_path===n}));o&&o.viewer&&(r===ae.s?(o.viewer.automaticallyCollapsed=!1,o.viewer.manuallyCollapsed=i):r===ae.p&&(o.viewer.automaticallyCollapsed=i,o.viewer.manuallyCollapsed=null)),o&&!i&&St(o)},[De](e,t){let{filePath:n,lines:i}=t;e.diffFiles.find((function(e){return e.file_path===n}))[ae.I]=i},ADD_CURRENT_VIEW_DIFF_FILE_LINES(e,t){let{filePath:n,line:i}=t;e.diffFiles.find((function(e){return e.file_path===n}))[ae.I].push(i)},TOGGLE_DIFF_FILE_RENDERING_MORE(e,t){const n=e.diffFiles.find((function(e){return e.file_path===t}));n.renderingLines=!n.renderingLines},[be](e,t){let{filePath:n,viewer:i}=t;Object(ve.e)(e.diffFiles,n,"file_path").viewer=i},SET_SHOW_SUGGEST_POPOVER(e){e.showSuggestPopover=!1},SET_FILE_BY_FILE(e,t){e.viewDiffsFileByFile=t},[Oe](e,t){e.mrReviews=t}};function wt(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,i)}return n}function jt(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Rt(e){return Object.entries(e).reduce((function(e,t){let[n,i]=t;const r=function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?wt(Object(n),!0).forEach((function(t){jt(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):wt(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({},e);return(i||0===i)&&(r[n]=i),r}),{})}function Pt(){let{message:e,values:t={}}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const n=Rt(t),i=Object.keys(n).map((function(e){return"%{".concat(e,"}")})).join("|"),r=new RegExp("(".concat(i,")"),"gm");return e.replace(r,(function(e){const t=e.replace(/(^%{|}$)/gm,"");return n[t]}))}function Lt(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,i)}return n}function yt(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Lt(Object(n),!0).forEach((function(t){Ct(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Lt(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function Ct(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}const At=function(e){var t;return(null===(t=e.startVersion)||void 0===t?void 0:t.version_index)||ae.n},Nt=function(e){return e.mergeRequestDiff.version_index},Ht=function(e){return e.contextCommitsDiff&&e.contextCommitsDiff.showing_context_commits_diff},Ut=function(e,t){var n,i;const r=(null===(n=window.gon)||void 0===n?void 0:null===(i=n.features)||void 0===i?void 0:i.defaultMergeRefForDiffs)||!1,o=Object(_.p)("diff_head"),s=Object(_.K)(o)||!o&&r,c=!e.startVersion&&!s,u=!e.startVersion&&s;let f=null;(!r||r&&!e.mergeRequestDiff.head_version_path)&&(f={versionName:e.targetBranchName,version_index:ae.n,href:e.mergeRequestDiff.base_version_path,isBase:!0,selected:c||r&&!e.mergeRequestDiff.head_version_path});const a={versionName:e.targetBranchName,version_index:ae.o,href:e.mergeRequestDiff.head_version_path,isHead:!0,selected:u};return[...e.mergeRequestDiffs.slice(1).map((function(e){return yt({href:e.compare_path,versionName:Object(h.f)(Object(h.a)("version %{versionIndex}"),{versionIndex:e.version_index}),selected:e.version_index===t.selectedTargetIndex},e)})),f,e.mergeRequestDiff.head_version_path&&a].filter((function(e){return e}))},Bt=function(e,t){const n=e.mergeRequestDiffs.map((function(e,n){const i=0===n;return yt(yt({},e),{},{href:e.version_path,commitsText:Object(h.d)("%d commit,","%d commits,",e.commits_count),isLatestVersion:i,versionName:i?Object(h.a)("latest version"):Object(h.f)(Object(h.a)("version %{versionIndex}"),{versionIndex:e.version_index}),selected:e.version_index===t.selectedSourceIndex&&!t.selectedContextCommitsDiffs})})),{contextCommitsDiff:i}=e;return i&&n.push({href:i.diffs_path,commitsText:Object(h.d)("%d commit","%d commits",i.commits_count),versionName:Object(h.a)("previously merged commits"),selected:t.selectedContextCommitsDiffs,addDivider:e.mergeRequestDiffs.length>0}),n};function Mt(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,i)}return n}function xt(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Mt(Object(n),!0).forEach((function(t){Vt(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Mt(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function Vt(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}const Gt=function(e){return e.diffViewType===ae.eb},Wt=function(e){return e.diffViewType===ae.J},qt=function(e){const t=e.diffFiles.some((function(e){var t;return null===(t=e.viewer)||void 0===t?void 0:t.automaticallyCollapsed})),n=e.diffFiles.some((function(e){var t;return null===(t=e.viewer)||void 0===t?void 0:t.manuallyCollapsed}));return{any:t||n,automatic:t,manual:n}},kt=function(e){return e.commit&&e.commit.id?e.commit.id:null},Qt=function(e,t){return function(e){const n=t.getDiffFileDiscussions(e);return n&&n.length&&n.every((function(e){return e.expanded}))||!1}},Jt=function(e,t){return function(e){const n=t.getDiffFileDiscussions(e);return n&&n.length&&n.every((function(e){return!e.expanded}))||!1}},$t=function(){return function(e){return e[ae.I].filter((function(e){return e.discussions.length>=1})).some((function(e){return e.discussionsExpanded}))}},Kt=function(){return function(e){return e[ae.I].some((function(e){return e.discussions.length>=1}))}},Yt=function(e,t,n,i){return function(e){return i.discussions.filter((function(t){return t.diff_discussion&&t.diff_file.file_hash===e.file_hash}))||[]}},Xt=function(e){return function(t){return e.diffFiles.find((function(e){return e.file_hash===t}))}},zt=function(e){return Object.values(e.treeEntries).filter((function(e){return"blob"===e.type}))},Zt=function(e,t){return t.flatBlobsList.reduce((function(e,t){const{parentPath:n}=t;return n&&!e.some((function(e){return e.path===n}))&&e.push({path:n,isHeader:!0,tree:[]}),e.find((function(e){return e.path===n})).tree.push(t),e}),[])},en=function(e){return function(t){return e.commentForms.find((function(e){return e.fileHash===t}))}},tn=function(e){return function(t,n){if(!e.coverageFiles.files)return{};const i=e.coverageFiles.files[t];if(!i)return{};const r=i[String(n)];return 0===r?{text:Object(h.a)("No test coverage"),class:"no-coverage"}:r>=0?{text:Object(h.d)("Test coverage: %d hit","Test coverage: %d hits",r),class:"coverage"}:{}}},nn=function(e){return Math.max(0,e.diffFiles.findIndex((function(t){return t.file_hash===e.currentDiffFileId})))},rn=function(e){return function(t,n){return n||e.diffViewType!==ae.J?Object(ve.n)(t.highlighted_diff_lines||[],e.diffViewType===ae.J):null}};function on(e,t,n){return function(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return Pt({message:e.defaultSuggestionCommitMessage,values:xt({branch_name:n.page.mrMetadata.branch_name,project_path:n.page.mrMetadata.project_path,project_name:n.page.mrMetadata.project_name,username:n.page.mrMetadata.username,user_full_name:n.page.mrMetadata.user_full_name},t)})}}const sn=function(e){var t,n;return!e.viewDiffsFileByFile&&(null===(t=window.gon)||void 0===t?void 0:null===(n=t.features)||void 0===n?void 0:n.diffsVirtualScrolling)};var cn=n("Ocj7"),un={SET_ACTIVE_TAB:"SET_ACTIVE_TAB",SET_ENDPOINTS:"SET_ENDPOINTS",SET_MR_METADATA:"SET_MR_METADATA"};function fn(e,t){let{commit:n}=e;n(un.SET_ACTIVE_TAB,t)}function an(e,t){let{commit:n}=e;n(un.SET_ENDPOINTS,t)}function ln(e,t){let{commit:n}=e;n(un.SET_MR_METADATA,t)}function dn(e){var t;let{dispatch:n,state:i}=e;(null===(t=i.endpoints)||void 0===t?void 0:t.metadata)&&m.a.get(i.endpoints.metadata).then((function(e){n("setMrMetadata",e.data)})).catch((function(){}))}var _n={isLoggedIn:(e,t)=>Boolean(t.getUserData.id)},hn={[un.SET_ACTIVE_TAB](e,t){Object.assign(e,{activeTab:t})},[un.SET_ENDPOINTS](e,t){Object.assign(e,{endpoints:t})},[un.SET_MR_METADATA](e,t){Object.assign(e,{mrMetadata:t})}};u.default.use(f.b);const mn=function(){return new f.b.Store({modules:{page:{state:{endpoints:{},activeTab:null,mrMetadata:{}},actions:c,getters:_n,mutations:hn},notes:Object(cn.a)(),diffs:{namespaced:!0,state:{isLoading:!0,isTreeLoaded:!1,isBatchLoading:!1,retrievingBatches:!1,addedLines:null,removedLines:null,endpoint:"",endpointUpdateUser:"",basePath:"",commit:null,startVersion:null,diffFiles:[],coverageFiles:{},mergeRequestDiffs:[],mergeRequestDiff:null,diffViewType:Object(ue.g)("view")[0]||gt||Ot,tree:[],treeEntries:{},showTreeList:!0,currentDiffFileId:"",projectPath:"",viewedDiffFileIds:{},commentForms:[],highlightedRow:null,renderTreeList:!0,showWhitespace:Object(ve.f)(Dt,bt),viewDiffsFileByFile:Object(Et.a)(),fileFinderVisible:!1,dismissEndpoint:"",showSuggestPopover:!0,defaultSuggestionCommitMessage:"",mrReviews:{},latestDiff:!0},getters:s,actions:o,mutations:Tt},batchComments:{namespaced:!0,state:{withBatchComments:!0,isDraftsFetched:!1,drafts:[],isPublishing:!1,currentlyPublishingDrafts:[]},mutations:te,actions:i,getters:r}}})};t.default=mn()}}]);
//# sourceMappingURL=mrNotesStore.ebde740c.chunk.js.map