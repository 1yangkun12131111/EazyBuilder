(this.webpackJsonp=this.webpackJsonp||[]).push([[474],{uOOt:function(t,e,n){"use strict";n.r(e);var i,o=n("jB52"),r=n("yi8e"),a=n("J7NB"),s=n("4lAS"),c=n("pbPB"),l=n("sF+2"),f=n("MV2A"),u=n("Lzak"),d={props:{language:{type:String,required:!0},tokens:{type:Array,required:!0}}},h=n("tBpV"),p=Object(h.a)(d,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("span",{staticClass:"line",attrs:{lang:t.language}},t._l(t.tokens,(function(e,i){return n("span",{key:i,class:e.class},[t._v(t._s(e.value))])})),0)}),[],!1,null,null,null).exports,b={components:{GlButton:s.a,GlTabs:c.a,GlTab:l.a,GlLink:f.a,GlBadge:u.a,DocLine:p},props:{position:{type:Object,required:!0},data:{type:Object,required:!0},definitionPathPrefix:{type:String,required:!0},blobPath:{type:String,required:!0}},data:()=>({offsetLeft:0}),computed:{isCurrentDefinition(){return this.data.definitionLineNumber-1===this.position.lineIndex},positionStyles(){return{left:"".concat(this.position.x-this.offsetLeft,"px"),top:"".concat(this.position.y+this.position.height,"px")}},definitionPath(){return this.data.definition_path?this.isDefinitionCurrentBlob?"#L".concat(this.data.definitionLineNumber):"".concat(this.definitionPathPrefix,"/").concat(this.data.definition_path):null},isDefinitionCurrentBlob(){return 0===this.data.definition_path.indexOf(this.blobPath)},references(){return this.data.references||[]}},watch:{position:{handler(){var t=this;this.$nextTick((function(){return t.updateOffsetLeft()}))},deep:!0,immediate:!0}},methods:{updateOffsetLeft(){this.offsetLeft=Math.max(0,this.$el.offsetLeft+this.$el.offsetWidth-window.innerWidth+20)}},colorScheme:null===(i=gon)||void 0===i?void 0:i.user_color_scheme};function g(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,i)}return n}function v(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?g(Object(n),!0).forEach((function(e){_(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):g(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function _(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var O={components:{Popover:Object(h.a)(b,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"popover code-navigation-popover popover-font-size-normal gl-popover bs-popover-bottom show",style:t.positionStyles},[n("div",{staticClass:"arrow",style:{left:t.offsetLeft+"px"}}),t._v(" "),n("gl-tabs",{attrs:{"nav-class":"gl-hidden","content-class":"gl-py-0"}},[n("gl-tab",{attrs:{title:t.__("Definition")}},[n("div",{staticClass:"overflow-auto code-navigation-popover-container"},t._l(t.data.hover,(function(e,i){return n("div",{key:i,class:{"border-bottom":i!==t.data.hover.length-1}},[e.language?n("pre",{ref:"code-output",refInFor:!0,staticClass:"border-0 bg-transparent m-0 code highlight text-wrap",class:t.$options.colorScheme},t._l(e.tokens,(function(t,i){return n("doc-line",{key:i,attrs:{language:e.language,tokens:t}})})),1):n("p",{ref:"doc-output",refInFor:!0,staticClass:"p-3 m-0"},[t._v("\n            "+t._s(e.value)+"\n          ")])])})),0),t._v(" "),t.definitionPath||t.isCurrentDefinition?n("div",{staticClass:"popover-body border-top"},[t.isCurrentDefinition?n("span",{staticClass:"gl-font-weight-bold gl-font-base"},[t._v("\n          "+t._s(t.s__("CodeIntelligence|This is the definition"))+"\n        ")]):n("gl-button",{staticClass:"w-100",attrs:{href:t.definitionPath,target:t.isDefinitionCurrentBlob?null:"_blank",variant:"default","data-testid":"go-to-definition-btn"}},[t._v("\n          "+t._s(t.__("Go to definition"))+"\n        ")])],1):t._e()]),t._v(" "),n("gl-tab",{staticClass:"py-2",attrs:{"data-testid":"references-tab"},scopedSlots:t._u([{key:"title",fn:function(){return[t._v("\n        "+t._s(t.__("References"))+"\n        "),n("gl-badge",{staticClass:"gl-tab-counter-badge",attrs:{size:"sm"}},[t._v(t._s(t.references.length))])]},proxy:!0}])},[t._v(" "),t.references.length?t._l(t.references,(function(e,i){return n("div",{key:i,staticClass:"gl-dropdown-item"},[n("gl-link",{staticClass:"dropdown-item",attrs:{href:t.definitionPathPrefix+"/"+e.path,"data-testid":"reference-link"}},[t._v("\n            "+t._s(e.path)+"\n          ")])],1)})):n("p",{staticClass:"gl-my-4 gl-px-4"},[t._v("\n        "+t._s(t.s__("CodeNavigation|No references found"))+"\n      ")])],2)],1)],1)}),[],!1,null,null,null).exports},computed:v({},Object(r.f)(["currentDefinition","currentDefinitionPosition","currentBlobPath","definitionPathPrefix"])),mounted(){this.body=document.body,a.a.$on("showBlobInteractionZones",this.showBlobInteractionZones),this.addGlobalEventListeners(),this.fetchData()},beforeDestroy(){a.a.$off("showBlobInteractionZones",this.showBlobInteractionZones),this.removeGlobalEventListeners()},methods:v(v({},Object(r.c)(["fetchData","showDefinition","showBlobInteractionZones"])),{},{addGlobalEventListeners(){this.body&&this.body.addEventListener("click",this.showDefinition)},removeGlobalEventListeners(){this.body&&this.body.removeEventListener("click",this.showDefinition)}})},y=Object(h.a)(O,(function(){var t=this.$createElement,e=this._self._c||t;return this.currentDefinition?e("popover",{attrs:{position:this.currentDefinitionPosition,data:this.currentDefinition,"definition-path-prefix":this.definitionPathPrefix,"blob-path":this.currentBlobPath}}):this._e()}),[],!1,null,null,null).exports,m=(n("pBsb"),n("2ibD"));n("Tznw"),n("6yen"),n("OeRx"),n("l/dT"),n("RqS2"),n("Zy7a"),n("cjZU"),n("OAhk"),n("X42P"),n("mHhP"),n("fn0I"),n("UB/6"),n("imhG"),n("orcL");const P=new Map,D=function(){return P.get("current")},w=function(t,e){const n=e.start_line+1,i=document.querySelector('[data-path="'.concat(t,'"]')).querySelectorAll(".blob-content #LC".concat(n,", .line_content:not(.old) #LC").concat(n));(null==i?void 0:i.length)&&i.forEach((function(t){let n=0;const i=[...t.childNodes].find((function(t){let{textContent:i}=t;return n===e.start_char||(n+=i.length,!1)}));i&&(i.setAttribute("data-char-index",e.start_char),i.setAttribute("data-line-index",e.start_line),i.classList.add("cursor-pointer","code-navigation","js-code-navigation"),i.closest(".line").classList.add("code-navigation-line"))}))};function j(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,i)}return n}function E(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?j(Object(n),!0).forEach((function(e){S(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):j(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function S(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var I={setInitialData(t,e){let{commit:n}=t;n("SET_INITIAL_DATA",e)},requestDataError(t){let{commit:e}=t;e("REQUEST_DATA_ERROR")},fetchData(t){let{commit:e,dispatch:n,state:i}=t;e("REQUEST_DATA"),i.blobs.forEach((function(t){let{path:i,codeNavigationPath:o}=t;m.a.get(o).then((function(t){let{data:n}=t;const o=n.reduce((function(t,e){var n;e.hover&&(t["".concat(e.start_line,":").concat(e.start_char)]=E(E({},e),{},{definitionLineNumber:parseInt((null===(n=e.definition_path)||void 0===n?void 0:n.split("#L").pop())||0,10)}),w(i,e));return t}),{});e("REQUEST_DATA_SUCCESS",{path:i,normalizedData:o})})).catch((function(){return n("requestDataError")}))}))},showBlobInteractionZones(t,e){let{state:n}=t;n.data&&n.data[e]&&Object.values(n.data[e]).forEach((function(t){return w(e,t)}))},showDefinition(t,e){let n,i,{commit:o,state:r}=t,{target:a}=e;if(!r.data)return;const s=a.classList.contains("hll");D()&&D().classList.remove("hll");const c=a.closest("[data-path]");if(!c)return void o("SET_CURRENT_DEFINITION",{definition:n,position:i});const l=c.dataset.path,f=r.data[l];if(f){if(a.closest(".js-code-navigation")&&!s){const{lineIndex:t,charIndex:e}=a.dataset,{x:o,y:r}=a.getBoundingClientRect();i={x:o||0,y:r+window.scrollY||0,height:a.offsetHeight,lineIndex:parseInt(t,10)},n=f["".concat(t,":").concat(e)],a.classList.add("hll"),function(t){P.set("current",t)}(a)}o("SET_CURRENT_DEFINITION",{definition:n,position:i,blobPath:l})}}};function C(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,i)}return n}function T(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?C(Object(n),!0).forEach((function(e){x(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):C(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function x(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var L={SET_INITIAL_DATA(t,e){let{blobs:n,definitionPathPrefix:i}=e;t.blobs=n,t.definitionPathPrefix=i},REQUEST_DATA(t){t.loading=!0},REQUEST_DATA_SUCCESS(t,e){let{path:n,normalizedData:i}=e;t.loading=!1,t.data=T(T({},t.data),{},{[n]:i})},REQUEST_DATA_ERROR(t){t.loading=!1},SET_CURRENT_DEFINITION(t,e){let{definition:n,position:i,blobPath:o}=e;t.currentDefinition=n,t.currentDefinitionPosition=i,t.currentBlobPath=o}};e.default=function(t){const e=document.getElementById("js-code-navigation");if(!e)return null;o.default.use(r.b);const n=new r.b.Store({actions:I,mutations:L,state:{blobs:[],loading:!1,data:null,currentDefinition:null,currentDefinitionPosition:null,currentBlobPath:null}});return n.dispatch("setInitialData",t),new o.default({el:e,store:n,render:t=>t(y)})}}}]);
//# sourceMappingURL=474.dcc55ada.chunk.js.map