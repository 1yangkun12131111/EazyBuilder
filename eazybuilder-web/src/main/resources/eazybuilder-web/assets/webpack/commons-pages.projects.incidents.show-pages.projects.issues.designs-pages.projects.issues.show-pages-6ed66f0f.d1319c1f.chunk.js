(this.webpackJsonp=this.webpackJsonp||[]).push([[28],{A2UA:function(e,t,n){"use strict";var i=n("7xOh");t.a=Object(i.a)()},IeAI:function(e,t,n){"use strict";n("S26F");var i=n("jqx9"),r=n.n(i),o=n("s1D3"),s=n("EmJ/"),a=n.n(s),l=(n("EJYk"),n("XRO8")),u=n("FVJN"),c=n("2ibD"),d=n("0AwG"),g=n("/lV4"),p=n("P0Xo"),h=n.n(p),m=(n("z4I3"),n("QifN"),n("pBsb"),n("Ch9p"),n("gAdM")),f=n.n(m),v=n("G3fq"),b=n.n(v),y=n("tDP3"),w=n("NmEs");const k=/\W|^\d+$/,S={Emojis:"emojis",Issues:"issues",Labels:"labels",Members:"members",MergeRequests:"mergeRequests",Milestones:"milestones",QuickActions:"commands",Snippets:"snippets"};function _(e,t,n){const i=t.slice(0,n).split("\n").length;return t.split("\n")[i-1].startsWith(e)}const C={[S.Emojis]:{config:{trigger:":",lookup:function(e){return e},menuItemLimit:100,menuItemTemplate:function(e){let{original:t}=e;return"".concat(t," ").concat(y.glEmojiTag(t))},selectTemplate:function(e){let{original:t}=e;return":".concat(t,":")}}},[S.Issues]:{config:{trigger:"#",lookup:function(e){return"".concat(e.iid).concat(e.title)},menuItemLimit:100,menuItemTemplate:function(e){let{original:t}=e;return"<small>".concat(t.reference||t.iid,"</small> ").concat(b()(t.title))},selectTemplate:function(e){let{original:t}=e;return t.reference||"#".concat(t.iid)}}},[S.Labels]:{config:{trigger:"~",lookup:"title",menuItemLimit:100,menuItemTemplate:function(e){let{original:t}=e;return'\n        <span class="dropdown-label-box" style="background: '.concat(b()(t.color),';"></span>\n        ').concat(b()(t.title))},selectTemplate:function(e){let{original:t}=e;return k.test(t.title)?'~"'.concat(b()(t.title),'"'):"~".concat(b()(t.title))}},filterValues(e){let{collection:t,fullText:n,selectionStart:i}=e;return _("/label",n,i)?t.filter((function(e){return!e.set})):_("/unlabel",n,i)?t.filter((function(e){return e.set})):t}},[S.Members]:{config:{trigger:"@",fillAttr:"username",lookup:function(e){return"Group"===e.type?f()(e.name.split(" / ")):"".concat(e.name).concat(e.username)},menuItemLimit:10,menuItemTemplate:function(e){let{original:t}=e;const n="gl-avatar gl-avatar-s32 gl-flex-shrink-0",i="".concat(n," gl-rounded-small\n        gl-display-flex gl-align-items-center gl-justify-content-center"),r=t.avatar_url?'<img class="'.concat(n,' gl-avatar-circle" src="').concat(t.avatar_url,'" alt="" />'):'<div class="'.concat(i,'" aria-hidden="true">\n            ').concat(t.username.charAt(0).toUpperCase(),"</div>");let o=t.name,s="@".concat(t.username);if("Group"===t.type){const e=t.name.split(" / ");o=e.pop(),s=e.pop()}const a=t.count&&!t.mentionsDisabled?" (".concat(t.count,")"):"",l=t.mentionsDisabled?Object(w.T)("notifications-off","s16 gl-ml-3"):"";return'\n        <div class="gl-display-flex gl-align-items-center">\n          '.concat(r,'\n          <div class="gl-line-height-normal gl-ml-4">\n            <div>').concat(b()(o)).concat(a,'</div>\n            <div class="gl-text-gray-700">').concat(b()(s),"</div>\n          </div>\n          ").concat(l,"\n        </div>\n      ")}},filterValues(e){let{assignees:t,collection:n,fullText:i,selectionStart:r}=e;return _("/assign",i,r)?n.filter((function(e){return!t.includes(e.username)})):_("/unassign",i,r)?n.filter((function(e){return t.includes(e.username)})):n}},[S.MergeRequests]:{config:{trigger:"!",lookup:function(e){return"".concat(e.iid).concat(e.title)},menuItemLimit:100,menuItemTemplate:function(e){let{original:t}=e;return"<small>".concat(t.reference||t.iid,"</small> ").concat(b()(t.title))},selectTemplate:function(e){let{original:t}=e;return t.reference||"!".concat(t.iid)}}},[S.Milestones]:{config:{trigger:"%",lookup:"title",menuItemLimit:100,menuItemTemplate:function(e){let{original:t}=e;return b()(t.title)},selectTemplate:function(e){let{original:t}=e;return'%"'.concat(b()(t.title),'"')}}},[S.QuickActions]:{config:{trigger:"/",fillAttr:"name",lookup:function(e){return"".concat(e.name).concat(e.aliases.join())},menuItemLimit:100,menuItemTemplate:function(e){let{original:t}=e;const n=t.aliases.length?"<small>(or /".concat(t.aliases.join(", /"),")</small>"):"",i=t.params.length?"<small>".concat(t.params.join(" "),"</small>"):"";let r="";if(t.warning){const e="confidential"===t.icon?Object(w.T)("eye-slash","s16 gl-mr-2"):"";r="<small>".concat(e,"<em>").concat(t.warning,"</em></small>")}else t.description&&(r="<small><em>".concat(t.description,"</em></small>"));return"<div>/".concat(t.name," ").concat(n," ").concat(i,"</div>\n          <div>").concat(r,"</div>")}}},[S.Snippets]:{config:{trigger:"$",fillAttr:"id",lookup:function(e){return"".concat(e.id).concat(e.title)},menuItemLimit:100,menuItemTemplate:function(e){let{original:t}=e;return"<small>".concat(t.id,"</small> ").concat(b()(t.title))}}}};var T=n("uyVa");function x(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,i)}return n}function A(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?x(Object(n),!0).forEach((function(t){O(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):x(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function O(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var M={errorMessage:Object(g.a)("An error occurred while getting autocomplete data. Please refresh the page and try again."),props:{autocompleteTypes:{type:Array,required:!1,default:function(){return Object.values(S)}},dataSources:{type:Object,required:!1,default:function(){var e;return(null===(e=gl.GfmAutoComplete)||void 0===e?void 0:e.dataSources)||{}}}},computed:{config(){var e=this;return this.autocompleteTypes.map((function(t){return A(A({},C[t].config),{},{loadingItemTemplate:'<span class="gl-spinner gl-vertical-align-text-bottom gl-ml-3 gl-mr-2"></span>'.concat(Object(g.a)("Loading")),requireLeadingSpace:!0,values:e.getValues(t)})}))}},mounted(){var e,t;this.cache={},this.tribute=new h.a({collection:this.config});const n=null===(e=this.$slots.default)||void 0===e?void 0:null===(t=e[0])||void 0===t?void 0:t.elm;this.tribute.attach(n)},beforeDestroy(){var e,t;const n=null===(e=this.$slots.default)||void 0===e?void 0:null===(t=e[0])||void 0===t?void 0:t.elm;this.tribute.detach(n)},methods:{cacheAssignees(){var e,t,n,i;const r=(null===(e=this.assignees)||void 0===e?void 0:e.length)===(null===(t=T.a.singleton)||void 0===t?void 0:null===(n=t.store)||void 0===n?void 0:null===(i=n.assignees)||void 0===i?void 0:i.length);var o,s,a;this.assignees&&r||(this.assignees=(null===(o=T.a.singleton)||void 0===o?void 0:null===(s=o.store)||void 0===s?void 0:null===(a=s.assignees)||void 0===a?void 0:a.map((function(e){return e.username})))||[])},filterValues(e){var t,n,i,r,o,s;return this.cacheAssignees(),C[e].filterValues?C[e].filterValues({assignees:this.assignees,collection:this.cache[e],fullText:null===(t=this.$slots.default)||void 0===t?void 0:null===(n=t[0])||void 0===n?void 0:null===(i=n.elm)||void 0===i?void 0:i.value,selectionStart:null===(r=this.$slots.default)||void 0===r?void 0:null===(o=r[0])||void 0===o?void 0:null===(s=o.elm)||void 0===s?void 0:s.selectionStart}):this.cache[e]},getValues(e){var t=this;return function(n,i){t.cache[e]?i(t.filterValues(e)):e===S.Emojis?y.initEmojiMap().then((function(){const n=y.getValidEmojiNames();t.cache[e]=n,i(n)})).catch((function(){return Object(l.b)({message:t.$options.errorMessage})})):t.dataSources[e]?c.a.get(t.dataSources[e]).then((function(n){t.cache[e]=n.data,i(t.filterValues(e))})).catch((function(){return Object(l.b)({message:t.$options.errorMessage})})):i([])}}},render(e){return e("div",this.$slots.default)}},E=n("tBpV"),j=Object(E.a)(M,void 0,void 0,!1,null,null,null).exports,P=n("KAYR"),I=n("sHIo"),L=n("A7K0"),D=n("4lAS"),q=n("LLbv"),B=n("d08M"),N=n("3E4U"),$={components:{GlIcon:o.a},directives:{GlTooltip:q.a},props:{buttonTitle:{type:String,required:!0},icon:{type:String,required:!0},tag:{type:String,required:!0},tagBlock:{type:String,required:!1,default:""},tagSelect:{type:String,required:!1,default:""},prepend:{type:Boolean,required:!1,default:!1},tagContent:{type:String,required:!1,default:""},cursorOffset:{type:Number,required:!1,default:0},shortcuts:{type:[String,Array],required:!1,default:function(){return[]}}},computed:{shortcutsString(){const e=Array.isArray(this.shortcuts)?this.shortcuts:[this.shortcuts];return JSON.stringify(e)}}},R={components:{ToolbarButton:Object(E.a)($,(function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("button",{directives:[{name:"gl-tooltip",rawName:"v-gl-tooltip"}],staticClass:"toolbar-btn js-md",attrs:{"data-md-tag":e.tag,"data-md-cursor-offset":e.cursorOffset,"data-md-select":e.tagSelect,"data-md-block":e.tagBlock,"data-md-tag-content":e.tagContent,"data-md-prepend":e.prepend,"data-md-shortcuts":e.shortcutsString,title:e.buttonTitle,"aria-label":e.buttonTitle,type:"button","data-container":"body"},on:{click:function(){return e.$emit("click")}}},[n("gl-icon",{attrs:{name:e.icon}})],1)}),[],!1,null,null,null).exports,GlIcon:o.a,GlPopover:L.a,GlButton:D.a},directives:{GlTooltip:q.a},props:{previewMarkdown:{type:Boolean,required:!0},lineContent:{type:String,required:!1,default:""},canSuggest:{type:Boolean,required:!1,default:!0},showSuggestPopover:{type:Boolean,required:!1,default:!1},suggestionStartIndex:{type:Number,required:!1,default:0}},data:()=>({tag:"> "}),computed:{mdTable:()=>["| header | header |","| ------ | ------ |","| cell | cell |","| cell | cell |"].join("\n"),mdSuggestion(){return[["```","suggestion:-".concat(this.suggestionStartIndex,"+0")].join(""),"{text}","```"].join("\n")},mdCollapsibleSection:()=>["<details><summary>Click to expand</summary>","{text}","</details>"].join("\n"),isMac(){var e,t;return Boolean(null===(e=window.gl)||void 0===e?void 0:null===(t=e.client)||void 0===t?void 0:t.isMac)},modifierKey(){return this.isMac?"⌘":Object(g.e)("KeyboardKey|Ctrl+")}},mounted(){a()(document).on("markdown-preview:show.vue",this.previewMarkdownTab),a()(document).on("markdown-preview:hide.vue",this.writeMarkdownTab)},beforeDestroy(){a()(document).off("markdown-preview:show.vue",this.previewMarkdownTab),a()(document).off("markdown-preview:hide.vue",this.writeMarkdownTab)},methods:{isValid(e){return!e||e.find(".js-vue-markdown-field").length&&a()(this.$el).closest("form")[0]===e[0]},previewMarkdownTab(e,t){e.target.blur&&e.target.blur(),this.isValid(t)&&this.$emit("preview-markdown")},writeMarkdownTab(e,t){e.target.blur&&e.target.blur(),this.isValid(t)&&this.$emit("write-markdown")},handleSuggestDismissed(){this.$emit("handleSuggestDismissed")},handleQuote(){const e=Object(w.r)();if(!e||!e.textContent)return void(this.tag="> ");this.tag="";const t=N.a.transformGFMSelection(e),n=this.$el.parentNode.querySelector("textarea");N.a.nodeToGFM(t).then((function(t){N.a.insertPastedText(n,e.textContent,N.a.quoted(t))})).catch((function(){}))}},shortcuts:{bold:Object(B.mb)(B.a),italic:Object(B.mb)(B.K),link:Object(B.mb)(B.L)}},F=Object(E.a)(R,(function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"md-header"},[n("ul",{staticClass:"nav-links clearfix"},[n("li",{staticClass:"md-header-tab",class:{active:!e.previewMarkdown}},[n("button",{staticClass:"js-write-link",attrs:{type:"button"},on:{click:function(t){return e.writeMarkdownTab(t)}}},[e._v("\n        "+e._s(e.__("Write"))+"\n      ")])]),e._v(" "),n("li",{staticClass:"md-header-tab",class:{active:e.previewMarkdown}},[n("button",{staticClass:"js-preview-link js-md-preview-button",attrs:{type:"button"},on:{click:function(t){return e.previewMarkdownTab(t)}}},[e._v("\n        "+e._s(e.__("Preview"))+"\n      ")])]),e._v(" "),n("li",{staticClass:"md-header-toolbar",class:{active:!e.previewMarkdown}},[n("div",{staticClass:"d-inline-block"},[n("toolbar-button",{attrs:{tag:"**","button-title":e.sprintf(e.s__("MarkdownEditor|Add bold text (%{modifierKey}B)"),{modifierKey:e.modifierKey}),shortcuts:e.$options.shortcuts.bold,icon:"bold"}}),e._v(" "),n("toolbar-button",{attrs:{tag:"_","button-title":e.sprintf(e.s__("MarkdownEditor|Add italic text (%{modifierKey}I)"),{modifierKey:e.modifierKey}),shortcuts:e.$options.shortcuts.italic,icon:"italic"}}),e._v(" "),n("toolbar-button",{attrs:{prepend:!0,tag:e.tag,"button-title":e.__("Insert a quote"),icon:"quote"},on:{click:e.handleQuote}})],1),e._v(" "),n("div",{staticClass:"d-inline-block ml-md-2 ml-0"},[e.canSuggest?[n("toolbar-button",{ref:"suggestButton",staticClass:"js-suggestion-btn",attrs:{tag:e.mdSuggestion,prepend:!0,"button-title":e.__("Insert suggestion"),"cursor-offset":4,"tag-content":e.lineContent,icon:"doc-code","data-qa-selector":"suggestion_button"},on:{click:e.handleSuggestDismissed}}),e._v(" "),e.showSuggestPopover&&e.$refs.suggestButton?n("gl-popover",{attrs:{target:e.$refs.suggestButton,"css-classes":["diff-suggest-popover"],placement:"bottom",show:e.showSuggestPopover}},[n("strong",[e._v(e._s(e.__("New! Suggest changes directly")))]),e._v(" "),n("p",{staticClass:"mb-2"},[e._v("\n              "+e._s(e.__("Suggest code changes which can be immediately applied in one click. Try it out!"))+"\n            ")]),e._v(" "),n("gl-button",{attrs:{variant:"info",category:"primary",size:"sm"},on:{click:e.handleSuggestDismissed}},[e._v("\n              "+e._s(e.__("Got it"))+"\n            ")])],1):e._e()]:e._e(),e._v(" "),n("toolbar-button",{attrs:{tag:"`","tag-block":"```","button-title":e.__("Insert code"),icon:"code"}}),e._v(" "),n("toolbar-button",{attrs:{tag:"[{text}](url)","tag-select":"url","button-title":e.sprintf(e.s__("MarkdownEditor|Add a link (%{modifierKey}K)"),{modifierKey:e.modifierKey}),shortcuts:e.$options.shortcuts.link,icon:"link"}})],2),e._v(" "),n("div",{staticClass:"d-inline-block ml-md-2 ml-0"},[n("toolbar-button",{attrs:{prepend:!0,tag:"- ","button-title":e.__("Add a bullet list"),icon:"list-bulleted"}}),e._v(" "),n("toolbar-button",{attrs:{prepend:!0,tag:"1. ","button-title":e.__("Add a numbered list"),icon:"list-numbered"}}),e._v(" "),n("toolbar-button",{attrs:{prepend:!0,tag:"- [ ] ","button-title":e.__("Add a task list"),icon:"list-task"}}),e._v(" "),n("toolbar-button",{attrs:{tag:e.mdCollapsibleSection,prepend:!0,"tag-select":"Click to expand","button-title":e.__("Add a collapsible section"),icon:"details-block"}}),e._v(" "),n("toolbar-button",{attrs:{tag:e.mdTable,prepend:!0,"button-title":e.__("Add a table"),icon:"table"}})],1),e._v(" "),n("div",{staticClass:"d-inline-block ml-md-2 ml-0"},[n("button",{directives:[{name:"gl-tooltip",rawName:"v-gl-tooltip"}],staticClass:"toolbar-btn toolbar-fullscreen-btn js-zen-enter",attrs:{"aria-label":e.__("Go full screen"),"data-container":"body",tabindex:"-1",title:e.__("Go full screen"),type:"button"}},[n("gl-icon",{attrs:{name:"maximize"}})],1)])])])])}),[],!1,null,null,null).exports,H=n("MV2A"),W=n("FkSe"),G=n("30su"),K=n("0adK"),V=n("LgEk"),z=n("i7S8"),U={inviteMembersInComment:z.a,components:{GlButton:D.a,GlLink:H.a,GlLoadingIcon:W.a,GlSprintf:G.a,GlIcon:o.a,InviteMembersTrigger:V.a},props:{markdownDocsPath:{type:String,required:!0},quickActionsDocsPath:{type:String,required:!1,default:""},canAttachFile:{type:Boolean,required:!1,default:!0}},computed:{hasQuickActionsDocsPath(){return""!==this.quickActionsDocsPath},inviteCommentEnabled:()=>Object(K.d)(z.a,"invite_member_link")}},Y={components:{GfmAutocomplete:j,MarkdownHeader:F,MarkdownToolbar:Object(E.a)(U,(function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"comment-toolbar clearfix"},[n("div",{staticClass:"toolbar-text"},[!e.hasQuickActionsDocsPath&&e.markdownDocsPath?[n("gl-link",{attrs:{href:e.markdownDocsPath,target:"_blank"}},[e._v("\n        "+e._s(e.__("Markdown is supported"))+"\n      ")])]:e._e(),e._v(" "),e.hasQuickActionsDocsPath&&e.markdownDocsPath?[n("gl-sprintf",{attrs:{message:e.__("%{markdownDocsLinkStart}Markdown%{markdownDocsLinkEnd} and %{quickActionsDocsLinkStart}quick actions%{quickActionsDocsLinkEnd} are supported")},scopedSlots:e._u([{key:"markdownDocsLink",fn:function(t){var i=t.content;return[n("gl-link",{attrs:{href:e.markdownDocsPath,target:"_blank"}},[e._v(e._s(i))])]}},{key:"quickActionsDocsLink",fn:function(t){var i=t.content;return[n("gl-link",{attrs:{href:e.quickActionsDocsPath,target:"_blank"}},[e._v(e._s(i))])]}}],null,!1,1533784681)})]:e._e()],2),e._v(" "),e.canAttachFile?n("span",{staticClass:"uploading-container"},[e.inviteCommentEnabled?n("invite-members-trigger",{attrs:{classes:"gl-mr-3 gl-vertical-align-text-bottom","display-text":e.s__("InviteMember|Invite Member"),icon:"assignee",variant:"link","track-experiment":e.$options.inviteMembersInComment,"trigger-source":e.$options.inviteMembersInComment,"data-track-event":"comment_invite_click"}}):e._e(),e._v(" "),n("span",{staticClass:"uploading-progress-container hide"},[n("gl-icon",{attrs:{name:"media"}}),e._v(" "),n("span",{staticClass:"attaching-file-message"}),e._v(" "),n("span",{staticClass:"uploading-progress"},[e._v("0%")]),e._v(" "),n("gl-loading-icon",{attrs:{inline:""}})],1),e._v(" "),n("span",{staticClass:"uploading-error-container hide"},[n("span",{staticClass:"uploading-error-icon"},[n("gl-icon",{attrs:{name:"media"}})],1),e._v(" "),n("span",{staticClass:"uploading-error-message"}),e._v(" "),n("gl-sprintf",{attrs:{message:e.__("%{retryButtonStart}Try again%{retryButtonEnd} or %{newFileButtonStart}attach a new file%{newFileButtonEnd}.")},scopedSlots:e._u([{key:"retryButton",fn:function(t){var i=t.content;return[n("gl-button",{staticClass:"retry-uploading-link gl-vertical-align-baseline",attrs:{variant:"link",category:"primary"}},[e._v("\n            "+e._s(i)+"\n          ")])]}},{key:"newFileButton",fn:function(t){var i=t.content;return[n("gl-button",{staticClass:"markdown-selector attach-new-file gl-vertical-align-baseline",attrs:{variant:"link",category:"primary"}},[e._v("\n            "+e._s(i)+"\n          ")])]}}],null,!1,3180960446)})],1),e._v(" "),n("gl-button",{staticClass:"markdown-selector button-attach-file gl-vertical-align-text-bottom",attrs:{icon:"media",variant:"link",category:"primary"}},[e._v("\n      "+e._s(e.__("Attach a file"))+"\n    ")]),e._v(" "),n("gl-button",{staticClass:"button-cancel-uploading-files gl-vertical-align-baseline hide",attrs:{variant:"link",category:"primary"}},[e._v("\n      "+e._s(e.__("Cancel"))+"\n    ")])],1):e._e()])}),[],!1,null,null,null).exports,GlIcon:o.a,Suggestions:P.a},mixins:[Object(I.a)()],props:{textareaValue:{type:String,required:!0},markdownDocsPath:{type:String,required:!0},isSubmitting:{type:Boolean,required:!1,default:!1},markdownPreviewPath:{type:String,required:!1,default:""},addSpacingClasses:{type:Boolean,required:!1,default:!0},quickActionsDocsPath:{type:String,required:!1,default:""},canAttachFile:{type:Boolean,required:!1,default:!0},uploadsPath:{type:String,required:!1,default:""},enableAutocomplete:{type:Boolean,required:!1,default:!0},line:{type:Object,required:!1,default:null},lines:{type:Array,required:!1,default:function(){return[]}},note:{type:Object,required:!1,default:function(){return{}}},canSuggest:{type:Boolean,required:!1,default:!1},helpPagePath:{type:String,required:!1,default:""},showSuggestPopover:{type:Boolean,required:!1,default:!1}},data(){return{markdownPreview:"",referencedCommands:"",referencedUsers:"",hasSuggestion:!1,markdownPreviewLoading:!1,previewMarkdown:!1,suggestions:this.note.suggestions||[]}},computed:{shouldShowReferencedUsers(){return this.referencedUsers.length>=10},lineContent(){if(this.lines.length)return this.lines.map((function(e){const{rich_text:t,text:n}=e;return n||r()(Object(d.q)(t).replace(/\n/g,""))})).join("\\n");if(this.line){const{rich_text:e,text:t}=this.line;return t||r()(Object(d.q)(e).replace(/\n/g,""))}return""},lineNumber(){let e;if(this.line){const{new_line:t,old_line:n}=this.line;e=t||n}return e},lineType(){return this.line?this.line.type:""},addMultipleToDiscussionWarning(){return Object(g.f)(Object(g.a)("You are about to add %{usersTag} people to the discussion. They will all receive a notification."),{usersTag:'<strong><span class="js-referenced-users-count">'.concat(this.referencedUsers.length,"</span></strong>")},!1)},suggestionsStartIndex(){return Math.max(this.lines.length-1,0)}},watch:{isSubmitting(e){if(!e||!this.$refs["markdown-preview"].querySelectorAll)return;const t=this.$refs["markdown-preview"].querySelectorAll("video, audio");t&&t.forEach((function(e){e.pause()}))}},mounted(){return new u.a(a()(this.$refs["gl-form"]),{emojis:this.enableAutocomplete&&!this.glFeatures.tributeAutocomplete,members:this.enableAutocomplete&&!this.glFeatures.tributeAutocomplete,issues:this.enableAutocomplete&&!this.glFeatures.tributeAutocomplete,mergeRequests:this.enableAutocomplete&&!this.glFeatures.tributeAutocomplete,epics:this.enableAutocomplete&&!this.glFeatures.tributeAutocomplete,milestones:this.enableAutocomplete&&!this.glFeatures.tributeAutocomplete,labels:this.enableAutocomplete&&!this.glFeatures.tributeAutocomplete,snippets:this.enableAutocomplete&&!this.glFeatures.tributeAutocomplete,vulnerabilities:this.enableAutocomplete},!0)},beforeDestroy(){const e=a()(this.$refs["gl-form"]).data("glForm");e&&e.destroy()},methods:{showPreviewTab(){var e=this;this.previewMarkdown||(this.previewMarkdown=!0,this.textareaValue?(this.markdownPreviewLoading=!0,this.markdownPreview=Object(g.a)("Loading…"),c.a.post(this.markdownPreviewPath,{text:this.textareaValue}).then((function(t){return e.renderMarkdown(t.data)})).catch((function(){return new l.c(Object(g.a)("Error loading markdown preview"))}))):this.renderMarkdown())},showWriteTab(){this.markdownPreview="",this.previewMarkdown=!1},renderMarkdown(){var e=this;let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.markdownPreviewLoading=!1,this.markdownPreview=t.body||Object(g.a)("Nothing to preview."),t.references&&(this.referencedCommands=t.references.commands,this.referencedUsers=t.references.users,this.hasSuggestion=t.references.suggestions&&t.references.suggestions.length,this.suggestions=t.references.suggestions),this.$nextTick().then((function(){return a()(e.$refs["markdown-preview"]).renderGFM()})).catch((function(){return new l.c(Object(g.a)("Error rendering markdown preview"))}))}}},X=Object(E.a)(Y,(function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{ref:"gl-form",staticClass:"js-vue-markdown-field md-area position-relative gfm-form",class:{"gl-mt-3 gl-mb-3":e.addSpacingClasses},attrs:{"data-uploads-path":e.uploadsPath}},[n("markdown-header",{attrs:{"preview-markdown":e.previewMarkdown,"line-content":e.lineContent,"can-suggest":e.canSuggest,"show-suggest-popover":e.showSuggestPopover,"suggestion-start-index":e.suggestionsStartIndex},on:{"preview-markdown":e.showPreviewTab,"write-markdown":e.showWriteTab,handleSuggestDismissed:function(){return e.$emit("handleSuggestDismissed")}}}),e._v(" "),n("div",{directives:[{name:"show",rawName:"v-show",value:!e.previewMarkdown,expression:"!previewMarkdown"}],staticClass:"md-write-holder"},[n("div",{staticClass:"zen-backdrop"},[e.glFeatures.tributeAutocomplete?n("gfm-autocomplete",[e._t("textarea")],2):e._t("textarea"),e._v(" "),n("a",{staticClass:"zen-control zen-control-leave js-zen-leave gl-text-gray-500",attrs:{href:"#","aria-label":e.__("Leave zen mode")}},[n("gl-icon",{attrs:{size:16,name:"minimize"}})],1),e._v(" "),n("markdown-toolbar",{attrs:{"markdown-docs-path":e.markdownDocsPath,"quick-actions-docs-path":e.quickActionsDocsPath,"can-attach-file":e.canAttachFile}})],2)]),e._v(" "),e.hasSuggestion?[n("div",{directives:[{name:"show",rawName:"v-show",value:e.previewMarkdown,expression:"previewMarkdown"}],ref:"markdown-preview",staticClass:"js-vue-md-preview md-preview-holder"},[e.hasSuggestion?n("suggestions",{attrs:{"note-html":e.markdownPreview,"from-line":e.lineNumber,"from-content":e.lineContent,"line-type":e.lineType,disabled:!0,suggestions:e.suggestions,"help-page-path":e.helpPagePath}}):e._e()],1)]:[n("div",{directives:[{name:"show",rawName:"v-show",value:e.previewMarkdown,expression:"previewMarkdown"}],ref:"markdown-preview",staticClass:"js-vue-md-preview md md-preview-holder",domProps:{innerHTML:e._s(e.markdownPreview)}})],e._v(" "),e.previewMarkdown&&!e.markdownPreviewLoading?[e.referencedCommands?n("div",{staticClass:"referenced-commands",domProps:{innerHTML:e._s(e.referencedCommands)}}):e._e(),e._v(" "),e.shouldShowReferencedUsers?n("div",{staticClass:"referenced-users"},[n("gl-icon",{attrs:{name:"warning-solid"}}),e._v(" "),n("span",{domProps:{innerHTML:e._s(e.addMultipleToDiscussionWarning)}})],1):e._e()]:e._e()],2)}),[],!1,null,null,null);t.a=X.exports},KAYR:function(e,t,n){"use strict";var i=n("R0j4"),r=n("jB52"),o=n("XRO8"),s=n("/lV4");n("S26F");function a(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,i)}return n}function l(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?a(Object(n),!0).forEach((function(t){u(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):a(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function u(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function c(e){return e?e.replace(/^( |\+|-)/,""):e}function d(e){return e.filter((function(e){return"match"!==e.type})).map((function(e){return function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return l(l({},e),{},{text:c(e.text),rich_text:c(e.rich_text)})}(e)}))}var g=n("s1D3"),p=n("4lAS"),h=n("FkSe"),m=n("LLbv"),f=n("Yyc1"),v=n("vDPP"),b=n("47in"),y={components:{GlDropdown:f.a,GlDropdownForm:v.a,GlFormTextarea:b.a,GlButton:p.a},props:{disabled:{type:Boolean,required:!1,default:!1},defaultCommitMessage:{type:String,required:!0}},data:()=>({message:null}),methods:{onApply(){this.$emit("apply",this.message)}}},w=n("tBpV"),k=Object(w.a)(y,(function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("gl-dropdown",{attrs:{text:e.__("Apply suggestion"),disabled:e.disabled,boundary:"window",right:"","menu-class":"gl-w-full!","data-qa-selector":"apply_suggestion_dropdown"},on:{shown:function(t){return e.$refs.commitMessage.$el.focus()}}},[n("gl-dropdown-form",{staticClass:"gl-px-4! gl-m-0!"},[n("label",{attrs:{for:"commit-message"}},[e._v(e._s(e.__("Commit message")))]),e._v(" "),n("gl-form-textarea",{ref:"commitMessage",attrs:{id:"commit-message",placeholder:e.defaultCommitMessage,"submit-on-enter":"","data-qa-selector":"commit_message_field"},on:{submit:e.onApply},model:{value:e.message,callback:function(t){e.message=t},expression:"message"}}),e._v(" "),n("gl-button",{staticClass:"gl-w-auto! gl-mt-3 gl-text-center! gl-hover-text-white! gl-transition-medium! float-right",attrs:{category:"primary",variant:"success","data-qa-selector":"commit_with_custom_message_button"},on:{click:e.onApply}},[e._v("\n      "+e._s(e.__("Apply"))+"\n    ")])],1)],1)}),[],!1,null,null,null).exports,S={components:{GlIcon:g.a,GlButton:p.a,GlLoadingIcon:h.a,ApplySuggestion:k},directives:{"gl-tooltip":m.a},props:{batchSuggestionsCount:{type:Number,required:!1,default:0},canApply:{type:Boolean,required:!1,default:!1},isApplied:{type:Boolean,required:!0,default:!1},isBatched:{type:Boolean,required:!1,default:!1},isApplyingBatch:{type:Boolean,required:!1,default:!1},helpPagePath:{type:String,required:!0},defaultCommitMessage:{type:String,required:!0},inapplicableReason:{type:String,required:!1,default:null},suggestionsCount:{type:Number,required:!1,default:0}},data:()=>({isApplyingSingle:!1}),computed:{isApplying(){return this.isApplyingSingle||this.isApplyingBatch},tooltipMessage(){return this.canApply?Object(s.a)("This also resolves this thread"):this.inapplicableReason},isDisableButton(){return this.isApplying||!this.canApply},applyingSuggestionsMessage(){return this.isApplyingSingle||this.batchSuggestionsCount<2?Object(s.a)("Applying suggestion..."):Object(s.a)("Applying suggestions...")},isLoggedIn:()=>Boolean(gon.current_user_id)},methods:{applySuggestion(e){this.canApply&&(this.isApplyingSingle=!0,this.$emit("apply",this.applySuggestionCallback,e))},applySuggestionCallback(){this.isApplyingSingle=!1},applySuggestionBatch(){this.canApply&&this.$emit("applyBatch")},addSuggestionToBatch(){this.$emit("addToBatch")},removeSuggestionFromBatch(){this.$emit("removeFromBatch")}}},_=Object(w.a)(S,(function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"md-suggestion-header border-bottom-0 mt-2"},[n("div",{staticClass:"js-suggestion-diff-header font-weight-bold"},[e._v("\n    "+e._s(e.__("Suggested change"))+"\n    "),e.helpPagePath?n("a",{staticClass:"js-help-btn",attrs:{href:e.helpPagePath,"aria-label":e.__("Help")}},[n("gl-icon",{attrs:{name:"question-o","css-classes":"link-highlight"}})],1):e._e()]),e._v(" "),e.isApplied?n("div",{staticClass:"badge badge-success"},[e._v(e._s(e.__("Applied")))]):e.isApplying?n("div",{staticClass:"d-flex align-items-center text-secondary"},[n("gl-loading-icon",{staticClass:"d-flex-center mr-2"}),e._v(" "),n("span",[e._v(e._s(e.applyingSuggestionsMessage))])],1):e.canApply&&e.isBatched?n("div",{staticClass:"d-flex align-items-center"},[n("gl-button",{staticClass:"btn-inverted js-remove-from-batch-btn btn-grouped",attrs:{disabled:e.isApplying},on:{click:e.removeSuggestionFromBatch}},[e._v("\n      "+e._s(e.__("Remove from batch"))+"\n    ")]),e._v(" "),n("gl-button",{directives:[{name:"gl-tooltip",rawName:"v-gl-tooltip.viewport",value:e.__("This also resolves all related threads"),expression:"__('This also resolves all related threads')",modifiers:{viewport:!0}}],staticClass:"btn-inverted js-apply-batch-btn btn-grouped",attrs:{"data-qa-selector":"apply_suggestions_batch_button",disabled:e.isApplying,variant:"success"},on:{click:e.applySuggestionBatch}},[e._v("\n      "+e._s(e.__("Apply suggestions"))+"\n      "),n("span",{staticClass:"badge badge-pill badge-pill-success"},[e._v("\n        "+e._s(e.batchSuggestionsCount)+"\n      ")])])],1):n("div",{staticClass:"d-flex align-items-center"},[e.suggestionsCount>1&&!e.isDisableButton?n("gl-button",{staticClass:"btn-inverted js-add-to-batch-btn btn-grouped",attrs:{"data-qa-selector":"add_suggestion_batch_button",disabled:e.isDisableButton},on:{click:e.addSuggestionToBatch}},[e._v("\n      "+e._s(e.__("Add suggestion to batch"))+"\n    ")]):e._e(),e._v(" "),e.isLoggedIn?n("apply-suggestion",{directives:[{name:"gl-tooltip",rawName:"v-gl-tooltip.viewport",value:e.tooltipMessage,expression:"tooltipMessage",modifiers:{viewport:!0}}],staticClass:"gl-ml-3",attrs:{disabled:e.isDisableButton,"default-commit-message":e.defaultCommitMessage},on:{apply:e.applySuggestion}}):e._e()],1)])}),[],!1,null,null,null).exports,C={name:"SuggestionDiffRow",props:{line:{type:Object,required:!0}},computed:{displayAsCell(){return!(this.line.rich_text||this.line.text)},lineType(){return this.line.type}}},T={components:{SuggestionDiffHeader:_,SuggestionDiffRow:Object(w.a)(C,(function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("tr",{staticClass:"line_holder",class:e.lineType},[n("td",{staticClass:"diff-line-num old_line border-top-0 border-bottom-0",class:e.lineType},[e._v("\n    "+e._s(e.line.old_line)+"\n  ")]),e._v(" "),n("td",{staticClass:"diff-line-num new_line border-top-0 border-bottom-0",class:e.lineType},[e._v("\n    "+e._s(e.line.new_line)+"\n  ")]),e._v(" "),n("td",{staticClass:"line_content",class:[{"d-table-cell":e.displayAsCell},e.lineType],attrs:{"data-testid":"suggestion-diff-content"}},[e.line.rich_text?n("span",{staticClass:"line",domProps:{innerHTML:e._s(e.line.rich_text)}}):e.line.text?n("span",{staticClass:"line"},[e._v(e._s(e.line.text))]):n("span",{staticClass:"line"})])])}),[],!1,null,null,null).exports},props:{suggestion:{type:Object,required:!0},batchSuggestionsInfo:{type:Array,required:!1,default:function(){return[]}},disabled:{type:Boolean,required:!1,default:!1},helpPagePath:{type:String,required:!0},defaultCommitMessage:{type:String,required:!0},suggestionsCount:{type:Number,required:!1,default:0}},computed:{batchSuggestionsCount(){return this.batchSuggestionsInfo.length},isBatched(){var e=this;return Boolean(this.batchSuggestionsInfo.find((function(t){let{suggestionId:n}=t;return n===e.suggestion.id})))},lines(){return d(this.suggestion.diff_lines)}},methods:{applySuggestion(e,t){this.$emit("apply",{suggestionId:this.suggestion.id,callback:e,message:t})},applySuggestionBatch(){this.$emit("applyBatch")},addSuggestionToBatch(){this.$emit("addToBatch",this.suggestion.id)},removeSuggestionFromBatch(){this.$emit("removeFromBatch",this.suggestion.id)}}},x=Object(w.a)(T,(function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"md-suggestion"},[n("suggestion-diff-header",{staticClass:"js-suggestion-diff-header",attrs:{"suggestions-count":e.suggestionsCount,"can-apply":e.suggestion.appliable&&e.suggestion.current_user.can_apply&&!e.disabled,"is-applied":e.suggestion.applied,"is-batched":e.isBatched,"is-applying-batch":e.suggestion.is_applying_batch,"batch-suggestions-count":e.batchSuggestionsCount,"help-page-path":e.helpPagePath,"default-commit-message":e.defaultCommitMessage,"inapplicable-reason":e.suggestion.inapplicable_reason},on:{apply:e.applySuggestion,applyBatch:e.applySuggestionBatch,addToBatch:e.addSuggestionToBatch,removeFromBatch:e.removeSuggestionFromBatch}}),e._v(" "),n("table",{staticClass:"mb-3 md-suggestion-diff js-syntax-highlight code"},[n("tbody",e._l(e.lines,(function(e,t){return n("suggestion-diff-row",{key:t+"-"+e.text,attrs:{line:e}})})),1)])],1)}),[],!1,null,null,null).exports,A={directives:{SafeHtml:i.a},props:{lineType:{type:String,required:!1,default:""},suggestions:{type:Array,required:!1,default:function(){return[]}},batchSuggestionsInfo:{type:Array,required:!1,default:function(){return[]}},noteHtml:{type:String,required:!0},disabled:{type:Boolean,required:!1,default:!1},helpPagePath:{type:String,required:!0},defaultCommitMessage:{type:String,required:!0},suggestionsCount:{type:Number,required:!1,default:0}},data:()=>({isRendered:!1}),watch:{suggestions(){this.reset()},noteHtml(){this.reset()}},mounted(){this.renderSuggestions()},beforeDestroy(){this.suggestionsWatch&&this.suggestionsWatch()},methods:{renderSuggestions(){var e=this;if(!this.noteHtml)return;const{container:t}=this.$refs,n=t.querySelectorAll(".js-render-suggestion");"old"===this.lineType&&Object(o.c)(Object(s.a)("Unable to apply suggestions to a deleted line."),"alert",this.$el),n.forEach((function(t,n){const i=t.parentElement;e.generateDiff(n).$mount(i)})),this.isRendered=!0},generateDiff(e){var t=this;const{suggestions:n,disabled:i,batchSuggestionsInfo:o,helpPagePath:s,defaultCommitMessage:a,suggestionsCount:l}=this,u=n&&n[e]?n[e]:{},c=new(r.default.extend(x))({propsData:{disabled:i,suggestion:u,batchSuggestionsInfo:o,helpPagePath:s,defaultCommitMessage:a,suggestionsCount:l}});return this.suggestionsWatch=this.$watch("suggestionsCount",(function(){c.suggestionsCount=t.suggestionsCount})),c.$on("apply",(function(e){let{suggestionId:n,callback:i,message:r}=e;t.$emit("apply",{suggestionId:n,callback:i,flashContainer:t.$el,message:r})})),c.$on("applyBatch",(function(){t.$emit("applyBatch",{flashContainer:t.$el})})),c.$on("addToBatch",(function(e){t.$emit("addToBatch",e)})),c.$on("removeFromBatch",(function(e){t.$emit("removeFromBatch",e)})),c},reset(){var e=this;this.$refs.container.innerHTML=this.noteHtml,this.isRendered=!1,this.renderSuggestions(),this.$nextTick((function(){return e.renderSuggestions()}))}}},O=Object(w.a)(A,(function(){var e=this.$createElement,t=this._self._c||e;return t("div",[t("div",{staticClass:"flash-container js-suggestions-flash"}),this._v(" "),t("div",{directives:[{name:"show",rawName:"v-show",value:this.isRendered,expression:"isRendered"},{name:"safe-html",rawName:"v-safe-html",value:this.noteHtml,expression:"noteHtml"}],ref:"container",staticClass:"md"})])}),[],!1,null,null,null);t.a=O.exports},LgEk:function(e,t,n){"use strict";var i=n("4lAS"),r=n("MV2A"),o=n("Zia5"),s=n("/lV4"),a=n("A2UA");function l(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,i)}return n}function u(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?l(Object(n),!0).forEach((function(t){c(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):l(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function c(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var d={components:{GlButton:i.a,GlLink:r.a},props:{displayText:{type:String,required:!1,default:Object(s.e)("InviteMembers|Invite team members")},icon:{type:String,required:!1,default:""},classes:{type:String,required:!1,default:""},variant:{type:String,required:!1,default:void 0},triggerSource:{type:String,required:!1,default:"unknown"},trackExperiment:{type:String,required:!1,default:void 0},triggerElement:{type:String,required:!1,default:"button"},event:{type:String,required:!1,default:""},label:{type:String,required:!1,default:""}},computed:{isButton(){return"button"===this.triggerElement},componentAttributes(){const e={class:this.classes,"data-qa-selector":"invite_members_button"};return this.event&&this.label?u(u({},e),{},{"data-track-event":this.event,"data-track-label":this.label}):e}},mounted(){this.trackExperimentOnShow()},methods:{openModal(){a.a.$emit("openModal",{inviteeType:"members",source:this.triggerSource})},trackExperimentOnShow(){if(this.trackExperiment){new o.a(this.trackExperiment).event("comment_invite_shown")}}}},g=n("tBpV"),p=Object(g.a)(d,(function(){var e=this,t=e.$createElement,n=e._self._c||t;return e.isButton?n("gl-button",e._b({attrs:{variant:e.variant,icon:e.icon},on:{click:e.openModal}},"gl-button",e.componentAttributes,!1),[e._v("\n  "+e._s(e.displayText)+"\n")]):n("gl-link",e._b({attrs:{"data-is-link":"true"},on:{click:e.openModal}},"gl-link",e.componentAttributes,!1),[e._v("\n  "+e._s(e.displayText)+"\n")])}),[],!1,null,null,null);t.a=p.exports},NjXk:function(e,t,n){var i=n("ERvI")({"&amp;":"&","&lt;":"<","&gt;":">","&quot;":'"',"&#39;":"'"});e.exports=i},P0Xo:function(e,t,n){(function(t){e.exports=function(){"use strict";function e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function n(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function i(e,t,i){return t&&n(e.prototype,t),i&&n(e,i),e}function r(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e)){var n=[],i=!0,r=!1,o=void 0;try{for(var s,a=e[Symbol.iterator]();!(i=(s=a.next()).done)&&(n.push(s.value),!t||n.length!==t);i=!0);}catch(e){r=!0,o=e}finally{try{i||null==a.return||a.return()}finally{if(r)throw o}}return n}}(e,t)||function(e,t){if(e){if("string"==typeof e)return o(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(n):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?o(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function o(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,i=new Array(t);n<t;n++)i[n]=e[n];return i}if(Array.prototype.find||(Array.prototype.find=function(e){if(null===this)throw new TypeError("Array.prototype.find called on null or undefined");if("function"!=typeof e)throw new TypeError("predicate must be a function");for(var t,n=Object(this),i=n.length>>>0,r=arguments[1],o=0;o<i;o++)if(t=n[o],e.call(r,t,o,n))return t}),window&&"function"!=typeof window.CustomEvent){var s=function(e,t){t=t||{bubbles:!1,cancelable:!1,detail:void 0};var n=document.createEvent("CustomEvent");return n.initCustomEvent(e,t.bubbles,t.cancelable,t.detail),n};void 0!==window.Event&&(s.prototype=window.Event.prototype),window.CustomEvent=s}var a=function(){function t(n){e(this,t),this.tribute=n,this.tribute.events=this}return i(t,[{key:"bind",value:function(e){e.boundKeydown=this.keydown.bind(e,this),e.boundKeyup=this.keyup.bind(e,this),e.boundInput=this.input.bind(e,this),e.addEventListener("keydown",e.boundKeydown,!1),e.addEventListener("keyup",e.boundKeyup,!1),e.addEventListener("input",e.boundInput,!1)}},{key:"unbind",value:function(e){e.removeEventListener("keydown",e.boundKeydown,!1),e.removeEventListener("keyup",e.boundKeyup,!1),e.removeEventListener("input",e.boundInput,!1),delete e.boundKeydown,delete e.boundKeyup,delete e.boundInput}},{key:"keydown",value:function(e,n){e.shouldDeactivate(n)&&(e.tribute.isActive=!1,e.tribute.hideMenu());var i=this;e.commandEvent=!1,t.keys().forEach((function(t){t.key===n.keyCode&&(e.commandEvent=!0,e.callbacks()[t.value.toLowerCase()](n,i))}))}},{key:"input",value:function(e,t){e.inputEvent=!0,e.keyup.call(this,e,t)}},{key:"click",value:function(e,t){var n=e.tribute;if(n.menu&&n.menu.contains(t.target)){var i=t.target;for(t.preventDefault(),t.stopPropagation();"li"!==i.nodeName.toLowerCase();)if(!(i=i.parentNode)||i===n.menu)throw new Error("cannot find the <li> container for the click");n.selectItemAtIndex(i.getAttribute("data-index"),t),n.hideMenu()}else n.current.element&&!n.current.externalTrigger&&(n.current.externalTrigger=!1,setTimeout((function(){return n.hideMenu()})))}},{key:"keyup",value:function(e,t){if(e.inputEvent&&(e.inputEvent=!1),e.updateSelection(this),27!==t.keyCode){if(!e.tribute.allowSpaces&&e.tribute.hasTrailingSpace)return e.tribute.hasTrailingSpace=!1,e.commandEvent=!0,void e.callbacks().space(t,this);if(!e.tribute.isActive)if(e.tribute.autocompleteMode)e.callbacks().triggerChar(t,this,"");else{var n=e.getKeyCode(e,this,t);if(isNaN(n)||!n)return;var i=e.tribute.triggers().find((function(e){return e.charCodeAt(0)===n}));void 0!==i&&e.callbacks().triggerChar(t,this,i)}e.tribute.current.mentionText.length<e.tribute.current.collection.menuShowMinLength||((e.tribute.current.trigger||e.tribute.autocompleteMode)&&!1===e.commandEvent||e.tribute.isActive&&8===t.keyCode)&&e.tribute.showMenuFor(this,!0)}}},{key:"shouldDeactivate",value:function(e){if(!this.tribute.isActive)return!1;if(0===this.tribute.current.mentionText.length){var n=!1;return t.keys().forEach((function(t){e.keyCode===t.key&&(n=!0)})),!n}return!1}},{key:"getKeyCode",value:function(e,t,n){var i=e.tribute,r=i.range.getTriggerInfo(!1,i.hasTrailingSpace,!0,i.allowSpaces,i.autocompleteMode);return!!r&&r.mentionTriggerChar.charCodeAt(0)}},{key:"updateSelection",value:function(e){this.tribute.current.element=e;var t=this.tribute.range.getTriggerInfo(!1,this.tribute.hasTrailingSpace,!0,this.tribute.allowSpaces,this.tribute.autocompleteMode);t&&(this.tribute.current.selectedPath=t.mentionSelectedPath,this.tribute.current.mentionText=t.mentionText,this.tribute.current.selectedOffset=t.mentionSelectedOffset)}},{key:"callbacks",value:function(){var e=this;return{triggerChar:function(t,n,i){var r=e.tribute;r.current.trigger=i;var o=r.collection.find((function(e){return e.trigger===i}));r.current.collection=o,r.current.mentionText.length>=r.current.collection.menuShowMinLength&&r.inputEvent&&r.showMenuFor(n,!0)},enter:function(t,n){e.tribute.isActive&&e.tribute.current.filteredItems&&(t.preventDefault(),t.stopPropagation(),setTimeout((function(){e.tribute.selectItemAtIndex(e.tribute.menuSelected,t),e.tribute.hideMenu()}),0))},escape:function(t,n){e.tribute.isActive&&(t.preventDefault(),t.stopPropagation(),e.tribute.isActive=!1,e.tribute.hideMenu())},tab:function(t,n){e.callbacks().enter(t,n)},space:function(t,n){e.tribute.isActive&&(e.tribute.spaceSelectsMatch?e.callbacks().enter(t,n):e.tribute.allowSpaces||(t.stopPropagation(),setTimeout((function(){e.tribute.hideMenu(),e.tribute.isActive=!1}),0)))},up:function(t,n){if(e.tribute.isActive&&e.tribute.current.filteredItems){t.preventDefault(),t.stopPropagation();var i=e.tribute.current.filteredItems.length,r=e.tribute.menuSelected;i>r&&r>0?(e.tribute.menuSelected--,e.setActiveLi()):0===r&&(e.tribute.menuSelected=i-1,e.setActiveLi(),e.tribute.menu.scrollTop=e.tribute.menu.scrollHeight)}},down:function(t,n){if(e.tribute.isActive&&e.tribute.current.filteredItems){t.preventDefault(),t.stopPropagation();var i=e.tribute.current.filteredItems.length-1,r=e.tribute.menuSelected;i>r?(e.tribute.menuSelected++,e.setActiveLi()):i===r&&(e.tribute.menuSelected=0,e.setActiveLi(),e.tribute.menu.scrollTop=0)}},delete:function(t,n){e.tribute.isActive&&e.tribute.current.mentionText.length<1?e.tribute.hideMenu():e.tribute.isActive&&e.tribute.showMenuFor(n)}}}},{key:"setActiveLi",value:function(e){var t=this.tribute.menu.querySelectorAll("li"),n=t.length>>>0;e&&(this.tribute.menuSelected=parseInt(e));for(var i=0;i<n;i++){var r=t[i];if(i===this.tribute.menuSelected){r.classList.add(this.tribute.current.collection.selectClass);var o=r.getBoundingClientRect(),s=this.tribute.menu.getBoundingClientRect();if(o.bottom>s.bottom){var a=o.bottom-s.bottom;this.tribute.menu.scrollTop+=a}else if(o.top<s.top){var l=s.top-o.top;this.tribute.menu.scrollTop-=l}}else r.classList.remove(this.tribute.current.collection.selectClass)}}},{key:"getFullHeight",value:function(e,t){var n=e.getBoundingClientRect().height;if(t){var i=e.currentStyle||window.getComputedStyle(e);return n+parseFloat(i.marginTop)+parseFloat(i.marginBottom)}return n}}],[{key:"keys",value:function(){return[{key:9,value:"TAB"},{key:8,value:"DELETE"},{key:13,value:"ENTER"},{key:27,value:"ESCAPE"},{key:32,value:"SPACE"},{key:38,value:"UP"},{key:40,value:"DOWN"}]}}]),t}(),l=function(){function t(n){e(this,t),this.tribute=n,this.tribute.menuEvents=this,this.menu=this.tribute.menu}return i(t,[{key:"bind",value:function(e){var t=this;this.menuClickEvent=this.tribute.events.click.bind(null,this),this.menuContainerScrollEvent=this.debounce((function(){t.tribute.isActive&&t.tribute.showMenuFor(t.tribute.current.element,!1)}),300,!1),this.windowResizeEvent=this.debounce((function(){t.tribute.isActive&&t.tribute.range.positionMenuAtCaret(!0)}),300,!1),this.tribute.range.getDocument().addEventListener("MSPointerDown",this.menuClickEvent,!1),this.tribute.range.getDocument().addEventListener("mousedown",this.menuClickEvent,!1),window.addEventListener("resize",this.windowResizeEvent),this.menuContainer?this.menuContainer.addEventListener("scroll",this.menuContainerScrollEvent,!1):window.addEventListener("scroll",this.menuContainerScrollEvent)}},{key:"unbind",value:function(e){this.tribute.range.getDocument().removeEventListener("mousedown",this.menuClickEvent,!1),this.tribute.range.getDocument().removeEventListener("MSPointerDown",this.menuClickEvent,!1),window.removeEventListener("resize",this.windowResizeEvent),this.menuContainer?this.menuContainer.removeEventListener("scroll",this.menuContainerScrollEvent,!1):window.removeEventListener("scroll",this.menuContainerScrollEvent)}},{key:"debounce",value:function(e,t,n){var i,r=arguments,o=this;return function(){var s=o,a=r,l=n&&!i;clearTimeout(i),i=setTimeout((function(){i=null,n||e.apply(s,a)}),t),l&&e.apply(s,a)}}}]),t}(),u=function(){function t(n){e(this,t),this.tribute=n,this.tribute.range=this}return i(t,[{key:"getDocument",value:function(){var e;return this.tribute.current.collection&&(e=this.tribute.current.collection.iframe),e?e.contentWindow.document:document}},{key:"positionMenuAtCaret",value:function(e){var t,n=this,i=this.tribute.current,r=this.getTriggerInfo(!1,this.tribute.hasTrailingSpace,!0,this.tribute.allowSpaces,this.tribute.autocompleteMode);if(void 0!==r){if(!this.tribute.positionMenu)return void(this.tribute.menu.style.cssText="display: block;");t=this.isContentEditable(i.element)?this.getContentEditableCaretPosition(r.mentionPosition):this.getTextAreaOrInputUnderlinePosition(this.tribute.current.element,r.mentionPosition),this.tribute.menu.style.cssText="top: ".concat(t.top,"px;\n                                     left: ").concat(t.left,"px;\n                                     right: ").concat(t.right,"px;\n                                     bottom: ").concat(t.bottom,"px;\n                                     position: absolute;\n                                     display: block;"),"auto"===t.left&&(this.tribute.menu.style.left="auto"),"auto"===t.top&&(this.tribute.menu.style.top="auto"),e&&this.scrollIntoView(),window.setTimeout((function(){var i={width:n.tribute.menu.offsetWidth,height:n.tribute.menu.offsetHeight},r=n.isMenuOffScreen(t,i),o=window.innerWidth>i.width&&(r.left||r.right),s=window.innerHeight>i.height&&(r.top||r.bottom);(o||s)&&(n.tribute.menu.style.cssText="display: none",n.positionMenuAtCaret(e))}),0)}else this.tribute.menu.style.cssText="display: none"}},{key:"selectElement",value:function(e,t,n){var i,r=e;if(t)for(var o=0;o<t.length;o++){if(void 0===(r=r.childNodes[t[o]]))return;for(;r.length<n;)n-=r.length,r=r.nextSibling;0!==r.childNodes.length||r.length||(r=r.previousSibling)}var s=this.getWindowSelection();(i=this.getDocument().createRange()).setStart(r,n),i.setEnd(r,n),i.collapse(!0);try{s.removeAllRanges()}catch(e){}s.addRange(i),e.focus()}},{key:"replaceTriggerText",value:function(e,t,n,i,r){var o=this.getTriggerInfo(!0,n,t,this.tribute.allowSpaces,this.tribute.autocompleteMode);if(void 0!==o){var s=this.tribute.current,a=new CustomEvent("tribute-replaced",{detail:{item:r,instance:s,context:o,event:i}});if(this.isContentEditable(s.element)){e+="string"==typeof this.tribute.replaceTextSuffix?this.tribute.replaceTextSuffix:" ";var l=o.mentionPosition+o.mentionText.length;this.tribute.autocompleteMode||(l+=o.mentionTriggerChar.length),this.pasteHtml(e,o.mentionPosition,l)}else{var u=this.tribute.current.element,c="string"==typeof this.tribute.replaceTextSuffix?this.tribute.replaceTextSuffix:" ";e+=c;var d=o.mentionPosition,g=o.mentionPosition+o.mentionText.length+c.length;this.tribute.autocompleteMode||(g+=o.mentionTriggerChar.length-1),u.value=u.value.substring(0,d)+e+u.value.substring(g,u.value.length),u.selectionStart=d+e.length,u.selectionEnd=d+e.length}s.element.dispatchEvent(new CustomEvent("input",{bubbles:!0})),s.element.dispatchEvent(a)}}},{key:"pasteHtml",value:function(e,t,n){var i,r;r=this.getWindowSelection(),(i=this.getDocument().createRange()).setStart(r.anchorNode,t),i.setEnd(r.anchorNode,n),i.deleteContents();var o=this.getDocument().createElement("div");o.innerHTML=e;for(var s,a,l=this.getDocument().createDocumentFragment();s=o.firstChild;)a=l.appendChild(s);i.insertNode(l),a&&((i=i.cloneRange()).setStartAfter(a),i.collapse(!0),r.removeAllRanges(),r.addRange(i))}},{key:"getWindowSelection",value:function(){return this.tribute.collection.iframe?this.tribute.collection.iframe.contentWindow.getSelection():window.getSelection()}},{key:"getNodePositionInParent",value:function(e){if(null===e.parentNode)return 0;for(var t=0;t<e.parentNode.childNodes.length;t++)if(e.parentNode.childNodes[t]===e)return t}},{key:"getContentEditableSelectedPath",value:function(e){var t=this.getWindowSelection(),n=t.anchorNode,i=[];if(null!=n){for(var r,o=n.contentEditable;null!==n&&"true"!==o;)r=this.getNodePositionInParent(n),i.push(r),null!==(n=n.parentNode)&&(o=n.contentEditable);return i.reverse(),{selected:n,path:i,offset:t.getRangeAt(0).startOffset}}}},{key:"getTextPrecedingCurrentSelection",value:function(){var e=this.tribute.current,t="";if(this.isContentEditable(e.element)){var n=this.getWindowSelection().anchorNode;if(null!=n){var i=n.textContent,r=this.getWindowSelection().getRangeAt(0).startOffset;i&&r>=0&&(t=i.substring(0,r))}}else{var o=this.tribute.current.element;if(o){var s=o.selectionStart;o.value&&s>=0&&(t=o.value.substring(0,s))}}return t}},{key:"getLastWordInText",value:function(e){var t;return e=e.replace(/\u00A0/g," "),(t=this.tribute.autocompleteSeparator?e.split(this.tribute.autocompleteSeparator):e.split(/\s+/))[t.length-1].trim()}},{key:"getTriggerInfo",value:function(e,t,n,i,r){var o,s,a,l=this,u=this.tribute.current;if(this.isContentEditable(u.element)){var c=this.getContentEditableSelectedPath(u);c&&(o=c.selected,s=c.path,a=c.offset)}else o=this.tribute.current.element;var d=this.getTextPrecedingCurrentSelection(),g=this.getLastWordInText(d);if(r)return{mentionPosition:d.length-g.length,mentionText:g,mentionSelectedElement:o,mentionSelectedPath:s,mentionSelectedOffset:a};if(null!=d){var p,h=-1;if(this.tribute.collection.forEach((function(e){var t=e.trigger,i=e.requireLeadingSpace?l.lastIndexWithLeadingSpace(d,t):d.lastIndexOf(t);i>h&&(h=i,p=t,n=e.requireLeadingSpace)})),h>=0&&(0===h||!n||/[\xA0\s]/g.test(d.substring(h-1,h)))){var m=d.substring(h+p.length,d.length);p=d.substring(h,h+p.length);var f=m.substring(0,1),v=m.length>0&&(" "===f||" "===f);t&&(m=m.trim());var b=i?/[^\S ]/g:/[\xA0\s]/g;if(this.tribute.hasTrailingSpace=b.test(m),!v&&(e||!b.test(m)))return{mentionPosition:h,mentionText:m,mentionSelectedElement:o,mentionSelectedPath:s,mentionSelectedOffset:a,mentionTriggerChar:p}}}}},{key:"lastIndexWithLeadingSpace",value:function(e,t){for(var n=e.split("").reverse().join(""),i=-1,r=0,o=e.length;r<o;r++){for(var s=r===e.length-1,a=/\s/.test(n[r+1]),l=!0,u=t.length-1;u>=0;u--)if(t[u]!==n[r-u]){l=!1;break}if(l&&(s||a)){i=e.length-1-r;break}}return i}},{key:"isContentEditable",value:function(e){return"INPUT"!==e.nodeName&&"TEXTAREA"!==e.nodeName}},{key:"isMenuOffScreen",value:function(e,t){var n=window.innerWidth,i=window.innerHeight,r=document.documentElement,o=(window.pageXOffset||r.scrollLeft)-(r.clientLeft||0),s=(window.pageYOffset||r.scrollTop)-(r.clientTop||0),a="number"==typeof e.top?e.top:s+i-e.bottom-t.height,l="number"==typeof e.right?e.right:e.left+t.width,u="number"==typeof e.bottom?e.bottom:e.top+t.height,c="number"==typeof e.left?e.left:o+n-e.right-t.width;return{top:a<Math.floor(s),right:l>Math.ceil(o+n),bottom:u>Math.ceil(s+i),left:c<Math.floor(o)}}},{key:"getMenuDimensions",value:function(){var e={width:null,height:null};return this.tribute.menu.style.cssText="top: 0px;\n                                 left: 0px;\n                                 position: fixed;\n                                 display: block;\n                                 visibility; hidden;",e.width=this.tribute.menu.offsetWidth,e.height=this.tribute.menu.offsetHeight,this.tribute.menu.style.cssText="display: none;",e}},{key:"getTextAreaOrInputUnderlinePosition",value:function(e,t,n){var i=null!==window.mozInnerScreenX,r=this.getDocument().createElement("div");r.id="input-textarea-caret-position-mirror-div",this.getDocument().body.appendChild(r);var o=r.style,s=window.getComputedStyle?getComputedStyle(e):e.currentStyle;o.whiteSpace="pre-wrap","INPUT"!==e.nodeName&&(o.wordWrap="break-word"),o.position="absolute",o.visibility="hidden",["direction","boxSizing","width","height","overflowX","overflowY","borderTopWidth","borderRightWidth","borderBottomWidth","borderLeftWidth","paddingTop","paddingRight","paddingBottom","paddingLeft","fontStyle","fontVariant","fontWeight","fontStretch","fontSize","fontSizeAdjust","lineHeight","fontFamily","textAlign","textTransform","textIndent","textDecoration","letterSpacing","wordSpacing"].forEach((function(e){o[e]=s[e]})),i?(o.width="".concat(parseInt(s.width)-2,"px"),e.scrollHeight>parseInt(s.height)&&(o.overflowY="scroll")):o.overflow="hidden",r.textContent=e.value.substring(0,t),"INPUT"===e.nodeName&&(r.textContent=r.textContent.replace(/\s/g," "));var a=this.getDocument().createElement("span");a.textContent=e.value.substring(t)||".",r.appendChild(a);var l=e.getBoundingClientRect(),u=document.documentElement,c=(window.pageXOffset||u.scrollLeft)-(u.clientLeft||0),d=(window.pageYOffset||u.scrollTop)-(u.clientTop||0),g=0,p=0;this.menuContainerIsBody&&(g=l.top,p=l.left);var h={top:g+d+a.offsetTop+parseInt(s.borderTopWidth)+parseInt(s.fontSize)-e.scrollTop,left:p+c+a.offsetLeft+parseInt(s.borderLeftWidth)},m=window.innerWidth,f=window.innerHeight,v=this.getMenuDimensions(),b=this.isMenuOffScreen(h,v);b.right&&(h.right=m-h.left,h.left="auto");var y=this.tribute.menuContainer?this.tribute.menuContainer.offsetHeight:this.getDocument().body.offsetHeight;if(b.bottom){var w=y-(f-(this.tribute.menuContainer?this.tribute.menuContainer.getBoundingClientRect():this.getDocument().body.getBoundingClientRect()).top);h.bottom=w+(f-l.top-a.offsetTop),h.top="auto"}return(b=this.isMenuOffScreen(h,v)).left&&(h.left=m>v.width?c+m-v.width:c,delete h.right),b.top&&(h.top=f>v.height?d+f-v.height:d,delete h.bottom),this.getDocument().body.removeChild(r),h}},{key:"getContentEditableCaretPosition",value:function(e){var t,n=this.getWindowSelection();(t=this.getDocument().createRange()).setStart(n.anchorNode,e),t.setEnd(n.anchorNode,e),t.collapse(!1);var i=t.getBoundingClientRect(),r=document.documentElement,o=(window.pageXOffset||r.scrollLeft)-(r.clientLeft||0),s=(window.pageYOffset||r.scrollTop)-(r.clientTop||0),a={left:i.left+o,top:i.top+i.height+s},l=window.innerWidth,u=window.innerHeight,c=this.getMenuDimensions(),d=this.isMenuOffScreen(a,c);d.right&&(a.left="auto",a.right=l-i.left-o);var g=this.tribute.menuContainer?this.tribute.menuContainer.offsetHeight:this.getDocument().body.offsetHeight;if(d.bottom){var p=g-(u-(this.tribute.menuContainer?this.tribute.menuContainer.getBoundingClientRect():this.getDocument().body.getBoundingClientRect()).top);a.top="auto",a.bottom=p+(u-i.top)}return(d=this.isMenuOffScreen(a,c)).left&&(a.left=l>c.width?o+l-c.width:o,delete a.right),d.top&&(a.top=u>c.height?s+u-c.height:s,delete a.bottom),this.menuContainerIsBody||(a.left=a.left?a.left-this.tribute.menuContainer.offsetLeft:a.left,a.top=a.top?a.top-this.tribute.menuContainer.offsetTop:a.top),a}},{key:"scrollIntoView",value:function(e){var t,n=this.menu;if(void 0!==n){for(;void 0===t||0===t.height;)if(0===(t=n.getBoundingClientRect()).height&&(void 0===(n=n.childNodes[0])||!n.getBoundingClientRect))return;var i=t.top,r=i+t.height;if(i<0)window.scrollTo(0,window.pageYOffset+t.top-20);else if(r>window.innerHeight){var o=window.pageYOffset+t.top-20;o-window.pageYOffset>100&&(o=window.pageYOffset+100);var s=window.pageYOffset-(window.innerHeight-r);s>o&&(s=o),window.scrollTo(0,s)}}}},{key:"menuContainerIsBody",get:function(){return this.tribute.menuContainer===document.body||!this.tribute.menuContainer}}]),t}(),c=function(){function t(n){e(this,t),this.tribute=n,this.tribute.search=this}return i(t,[{key:"simpleFilter",value:function(e,t){var n=this;return t.filter((function(t){return n.test(e,t)}))}},{key:"test",value:function(e,t){return null!==this.match(e,t)}},{key:"match",value:function(e,t,n){n=n||{},t.length;var i=n.pre||"",r=n.post||"",o=n.caseSensitive&&t||t.toLowerCase();if(n.skip)return{rendered:t,score:0};e=n.caseSensitive&&e||e.toLowerCase();var s=this.traverse(o,e,0,0,[]);return s?{rendered:this.render(t,s.cache,i,r),score:s.score}:null}},{key:"traverse",value:function(e,t,n,i,r){if(this.tribute.autocompleteSeparator&&(t=t.split(this.tribute.autocompleteSeparator).splice(-1)[0]),t.length===i)return{score:this.calculateScore(r),cache:r.slice()};if(!(e.length===n||t.length-i>e.length-n)){for(var o,s,a=t[i],l=e.indexOf(a,n);l>-1;){if(r.push(l),s=this.traverse(e,t,l+1,i+1,r),r.pop(),!s)return o;(!o||o.score<s.score)&&(o=s),l=e.indexOf(a,l+1)}return o}}},{key:"calculateScore",value:function(e){var t=0,n=1;return e.forEach((function(i,r){r>0&&(e[r-1]+1===i?n+=n+1:n=1),t+=n})),t}},{key:"render",value:function(e,t,n,i){var r=e.substring(0,t[0]);return t.forEach((function(o,s){r+=n+e[o]+i+e.substring(o+1,t[s+1]?t[s+1]:e.length)})),r}},{key:"filter",value:function(e,t,n){var i=this;return n=n||{},t.reduce((function(t,r,o,s){var a=r;n.extract&&((a=n.extract(r))||(a=""));var l=i.match(e,a,n);return null!=l&&(t[t.length]={string:l.rendered,score:l.score,index:o,original:r}),t}),[]).sort((function(e,t){return t.score-e.score||e.index-t.index}))}}]),t}();return function(){function n(t){var i,r=this,o=t.values,s=void 0===o?null:o,d=t.loadingItemTemplate,g=void 0===d?null:d,p=t.iframe,h=void 0===p?null:p,m=t.selectClass,f=void 0===m?"highlight":m,v=t.containerClass,b=void 0===v?"tribute-container":v,y=t.itemClass,w=void 0===y?"":y,k=t.trigger,S=void 0===k?"@":k,_=t.autocompleteMode,C=void 0!==_&&_,T=t.autocompleteSeparator,x=void 0===T?null:T,A=t.selectTemplate,O=void 0===A?null:A,M=t.menuItemTemplate,E=void 0===M?null:M,j=t.lookup,P=void 0===j?"key":j,I=t.fillAttr,L=void 0===I?"value":I,D=t.collection,q=void 0===D?null:D,B=t.menuContainer,N=void 0===B?null:B,$=t.noMatchTemplate,R=void 0===$?null:$,F=t.requireLeadingSpace,H=void 0===F||F,W=t.allowSpaces,G=void 0!==W&&W,K=t.replaceTextSuffix,V=void 0===K?null:K,z=t.positionMenu,U=void 0===z||z,Y=t.spaceSelectsMatch,X=void 0!==Y&&Y,Q=t.searchOpts,J=void 0===Q?{}:Q,Z=t.menuItemLimit,ee=void 0===Z?null:Z,te=t.menuShowMinLength,ne=void 0===te?0:te;if(e(this,n),this.autocompleteMode=C,this.autocompleteSeparator=x,this.menuSelected=0,this.current={},this.inputEvent=!1,this.isActive=!1,this.menuContainer=N,this.allowSpaces=G,this.replaceTextSuffix=V,this.positionMenu=U,this.hasTrailingSpace=!1,this.spaceSelectsMatch=X,this.autocompleteMode&&(S="",G=!1),s)this.collection=[{trigger:S,iframe:h,selectClass:f,containerClass:b,itemClass:w,selectTemplate:(O||n.defaultSelectTemplate).bind(this),menuItemTemplate:(E||n.defaultMenuItemTemplate).bind(this),noMatchTemplate:(i=R,"string"==typeof i?""===i.trim()?null:i:"function"==typeof i?i.bind(r):R||function(){return"<li>No Match Found!</li>"}.bind(r)),lookup:P,fillAttr:L,values:s,loadingItemTemplate:g,requireLeadingSpace:H,searchOpts:J,menuItemLimit:ee,menuShowMinLength:ne}];else{if(!q)throw new Error("[Tribute] No collection specified.");this.autocompleteMode&&console.warn("Tribute in autocomplete mode does not work for collections"),this.collection=q.map((function(e){return{trigger:e.trigger||S,iframe:e.iframe||h,selectClass:e.selectClass||f,containerClass:e.containerClass||b,itemClass:e.itemClass||w,selectTemplate:(e.selectTemplate||n.defaultSelectTemplate).bind(r),menuItemTemplate:(e.menuItemTemplate||n.defaultMenuItemTemplate).bind(r),noMatchTemplate:function(e){return"string"==typeof e?""===e.trim()?null:e:"function"==typeof e?e.bind(r):R||function(){return"<li>No Match Found!</li>"}.bind(r)}(R),lookup:e.lookup||P,fillAttr:e.fillAttr||L,values:e.values,loadingItemTemplate:e.loadingItemTemplate,requireLeadingSpace:e.requireLeadingSpace,searchOpts:e.searchOpts||J,menuItemLimit:e.menuItemLimit||ee,menuShowMinLength:e.menuShowMinLength||ne}}))}new u(this),new a(this),new l(this),new c(this)}return i(n,[{key:"triggers",value:function(){return this.collection.map((function(e){return e.trigger}))}},{key:"attach",value:function(e){if(!e)throw new Error("[Tribute] Must pass in a DOM node or NodeList.");if(void 0!==t&&e instanceof t&&(e=e.get()),e.constructor===NodeList||e.constructor===HTMLCollection||e.constructor===Array)for(var n=e.length,i=0;i<n;++i)this._attach(e[i]);else this._attach(e)}},{key:"_attach",value:function(e){e.hasAttribute("data-tribute")&&console.warn("Tribute was already bound to "+e.nodeName),this.ensureEditable(e),this.events.bind(e),e.setAttribute("data-tribute",!0)}},{key:"ensureEditable",value:function(e){if(-1===n.inputTypes().indexOf(e.nodeName)){if(!e.contentEditable)throw new Error("[Tribute] Cannot bind to "+e.nodeName);e.contentEditable=!0}}},{key:"createMenu",value:function(e){var t=this.range.getDocument().createElement("div"),n=this.range.getDocument().createElement("ul");return t.className=e,t.appendChild(n),this.menuContainer?this.menuContainer.appendChild(t):this.range.getDocument().body.appendChild(t)}},{key:"showMenuFor",value:function(e,t){var n=this;if(!this.isActive||this.current.element!==e||this.current.mentionText!==this.currentMentionTextSnapshot){this.currentMentionTextSnapshot=this.current.mentionText,this.menu||(this.menu=this.createMenu(this.current.collection.containerClass),e.tributeMenu=this.menu,this.menuEvents.bind(this.menu)),this.isActive=!0,this.menuSelected=0,this.current.mentionText||(this.current.mentionText="");var i=function(e){if(n.isActive){var i=n.search.filter(n.current.mentionText,e,{pre:n.current.collection.searchOpts.pre||"<span>",post:n.current.collection.searchOpts.post||"</span>",skip:n.current.collection.searchOpts.skip,extract:function(e){if("string"==typeof n.current.collection.lookup)return e[n.current.collection.lookup];if("function"==typeof n.current.collection.lookup)return n.current.collection.lookup(e,n.current.mentionText);throw new Error("Invalid lookup attribute, lookup must be string or function.")}});n.current.collection.menuItemLimit&&(i=i.slice(0,n.current.collection.menuItemLimit)),n.current.filteredItems=i;var o=n.menu.querySelector("ul");if(n.range.positionMenuAtCaret(t),!i.length){var s=new CustomEvent("tribute-no-match",{detail:n.menu});return n.current.element.dispatchEvent(s),void("function"==typeof n.current.collection.noMatchTemplate&&!n.current.collection.noMatchTemplate()||!n.current.collection.noMatchTemplate?n.hideMenu():"function"==typeof n.current.collection.noMatchTemplate?o.innerHTML=n.current.collection.noMatchTemplate():o.innerHTML=n.current.collection.noMatchTemplate)}o.innerHTML="";var a=n.range.getDocument().createDocumentFragment();i.forEach((function(e,t){var i=n.range.getDocument().createElement("li");i.setAttribute("data-index",t),i.className=n.current.collection.itemClass,i.addEventListener("mousemove",(function(e){var t=r(n._findLiTarget(e.target),2),i=(t[0],t[1]);0!==e.movementY&&n.events.setActiveLi(i)})),n.menuSelected===t&&i.classList.add(n.current.collection.selectClass),i.innerHTML=n.current.collection.menuItemTemplate(e),a.appendChild(i)})),o.appendChild(a)}};"function"==typeof this.current.collection.values?(this.current.collection.loadingItemTemplate&&(this.menu.querySelector("ul").innerHTML=this.current.collection.loadingItemTemplate,this.range.positionMenuAtCaret(t)),this.current.collection.values(this.current.mentionText,i)):i(this.current.collection.values)}}},{key:"_findLiTarget",value:function(e){if(!e)return[];var t=e.getAttribute("data-index");return t?[e,t]:this._findLiTarget(e.parentNode)}},{key:"showMenuForCollection",value:function(e,t){e!==document.activeElement&&this.placeCaretAtEnd(e),this.current.collection=this.collection[t||0],this.current.externalTrigger=!0,this.current.element=e,e.isContentEditable?this.insertTextAtCursor(this.current.collection.trigger):this.insertAtCaret(e,this.current.collection.trigger),this.showMenuFor(e)}},{key:"placeCaretAtEnd",value:function(e){if(e.focus(),void 0!==window.getSelection&&void 0!==document.createRange){var t=document.createRange();t.selectNodeContents(e),t.collapse(!1);var n=window.getSelection();n.removeAllRanges(),n.addRange(t)}else if(void 0!==document.body.createTextRange){var i=document.body.createTextRange();i.moveToElementText(e),i.collapse(!1),i.select()}}},{key:"insertTextAtCursor",value:function(e){var t,n;(n=(t=window.getSelection()).getRangeAt(0)).deleteContents();var i=document.createTextNode(e);n.insertNode(i),n.selectNodeContents(i),n.collapse(!1),t.removeAllRanges(),t.addRange(n)}},{key:"insertAtCaret",value:function(e,t){var n=e.scrollTop,i=e.selectionStart,r=e.value.substring(0,i),o=e.value.substring(e.selectionEnd,e.value.length);e.value=r+t+o,i+=t.length,e.selectionStart=i,e.selectionEnd=i,e.focus(),e.scrollTop=n}},{key:"hideMenu",value:function(){this.menu&&(this.menu.style.cssText="display: none;",this.isActive=!1,this.menuSelected=0,this.current={})}},{key:"selectItemAtIndex",value:function(e,t){if("number"==typeof(e=parseInt(e))&&!isNaN(e)){var n=this.current.filteredItems[e],i=this.current.collection.selectTemplate(n);null!==i&&this.replaceText(i,t,n)}}},{key:"replaceText",value:function(e,t,n){this.range.replaceTriggerText(e,!0,!0,t,n)}},{key:"_append",value:function(e,t,n){if("function"==typeof e.values)throw new Error("Unable to append to values, as it is a function.");e.values=n?t:e.values.concat(t)}},{key:"append",value:function(e,t,n){var i=parseInt(e);if("number"!=typeof i)throw new Error("please provide an index for the collection to update.");var r=this.collection[i];this._append(r,t,n)}},{key:"appendCurrent",value:function(e,t){if(!this.isActive)throw new Error("No active state. Please use append instead and pass an index.");this._append(this.current.collection,e,t)}},{key:"detach",value:function(e){if(!e)throw new Error("[Tribute] Must pass in a DOM node or NodeList.");if(void 0!==t&&e instanceof t&&(e=e.get()),e.constructor===NodeList||e.constructor===HTMLCollection||e.constructor===Array)for(var n=e.length,i=0;i<n;++i)this._detach(e[i]);else this._detach(e)}},{key:"_detach",value:function(e){var t=this;this.events.unbind(e),e.tributeMenu&&this.menuEvents.unbind(e.tributeMenu),setTimeout((function(){e.removeAttribute("data-tribute"),t.isActive=!1,e.tributeMenu&&e.tributeMenu.remove()}))}},{key:"isActive",get:function(){return this._isActive},set:function(e){if(this._isActive!=e&&(this._isActive=e,this.current.element)){var t=new CustomEvent("tribute-active-".concat(e));this.current.element.dispatchEvent(t)}}}],[{key:"defaultSelectTemplate",value:function(e){return void 0===e?"".concat(this.current.collection.trigger).concat(this.current.mentionText):this.range.isContentEditable(this.current.element)?'<span class="tribute-mention">'+(this.current.collection.trigger+e.original[this.current.collection.fillAttr])+"</span>":this.current.collection.trigger+e.original[this.current.collection.fillAttr]}},{key:"defaultMenuItemTemplate",value:function(e){return e.string}},{key:"inputTypes",value:function(){return["TEXTAREA","INPUT"]}}]),n}()}()}).call(this,n("EmJ/"))},Q78f:function(e,t,n){"use strict";n.d(t,"b",(function(){return s})),n.d(t,"a",(function(){return a}));var i=n("0zRR"),r=n("/Szx"),o=n("lgrP"),s={id:{type:String},inline:{type:Boolean,default:!1},novalidate:{type:Boolean,default:!1},validated:{type:Boolean,default:!1}},a=r.a.extend({name:i.w,functional:!0,props:s,render:function(e,t){var n=t.props,i=t.data,r=t.children;return e("form",Object(o.a)(i,{class:{"form-inline":n.inline,"was-validated":n.validated},attrs:{id:n.id,novalidate:n.novalidate}}),r)}})},Zia5:function(e,t,n){"use strict";n.d(t,"a",(function(){return u}));var i=n("4ZIW"),r=n("FoG6"),o=n("0adK");function s(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,i)}return n}function a(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?s(Object(n),!0).forEach((function(t){l(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):s(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function l(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}class u{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this.trackingArgs=t,this.data=Object(o.b)(e)}event(e){return!!this.data&&i.a.event(document.body.dataset.page,e,a(a({},this.trackingArgs),{},{context:{schema:r.c,data:this.data}}))}}},gAdM:function(e,t){e.exports=function(e){var t=null==e?0:e.length;return t?e[t-1]:void 0}},i7S8:function(e,t,n){"use strict";n.d(t,"b",(function(){return i})),n.d(t,"a",(function(){return r}));const i=200,r="invite_members_in_comment"},jqx9:function(e,t,n){var i=n("rhmX"),r=n("NjXk"),o=/&(?:amp|lt|gt|quot|#39);/g,s=RegExp(o.source);e.exports=function(e){return(e=i(e))&&s.test(e)?e.replace(o,r):e}},sHIo:function(e,t,n){"use strict";t.a=function(){return{inject:{glFeatures:{from:"glFeatures",default:function(){return{}}}}}}},vDPP:function(e,t,n){"use strict";var i=n("0zRR"),r=n("/Szx"),o=n("lgrP"),s=n("Q78f");function a(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,i)}return n}function l(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?a(Object(n),!0).forEach((function(t){u(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):a(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function u(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var c=r.a.extend({name:i.r,functional:!0,props:l(l({},s.b),{},{disabled:{type:Boolean,default:!1},formClass:{type:[String,Object,Array]}}),render:function(e,t){var n=t.props,i=t.data,r=t.children,a=i.attrs||{},u=i.on||{};return i.attrs={},i.on={},e("li",Object(o.a)(i,{attrs:{role:"presentation"}}),[e(s.a,{ref:"form",staticClass:"b-dropdown-form",class:[n.formClass,{disabled:n.disabled}],props:n,attrs:l(l({},a),{},{disabled:n.disabled,tabindex:n.disabled?null:"-1"}),on:u},r)])}}),d=n("Pyw5");const g={components:{BDropdownForm:c},inheritAttrs:!1};const p=n.n(d)()({render:function(){var e=this.$createElement;return(this._self._c||e)("b-dropdown-form",this._g(this._b({attrs:{"form-class":"gl-p-0"}},"b-dropdown-form",this.$attrs,!1),this.$listeners),[this._t("default")],2)},staticRenderFns:[]},void 0,g,void 0,!1,void 0,!1,void 0,void 0,void 0);t.a=p}}]);
//# sourceMappingURL=commons-pages.projects.incidents.show-pages.projects.issues.designs-pages.projects.issues.show-pages-6ed66f0f.d1319c1f.chunk.js.map